clean:
	find . -name '*.sal' -o  -name '*.dot' -o  -name '*.png' -o  -name '*.thy~' -o  -name '*Theorems.thy' -o  -name 'Error_*.thy' -o  -name 'XXX*.thy' -name 'XX*.thy'| xargs rm ;\
	find . -name 'XX*.thy' | xargs rm ;\
	grep -Ril "Generated by the SAL to Isabelle Translator" --include \*.thy | xargs rm


testwf:
	find . -name '*.sal' | xargs -n 1 sal-wfc

# An alternative to realpath --relative-to using sed to drop $HOME
# Leaving it in for posterity in case we need it somewhere else
# test:
# 	file=/home/michael/Documents/efsm-sal/examples/lift-controller/XXDOTXXLift_Controller.thy ;\
# 	echo $$file $$HOME; \
# 	txt=`echo $$file | sed -e "s~$$HOME~~"`; \
# 	echo $$txt

testisabellesal:
	# we need the file path relative to $HOME since this is how the translator works
	for file in $(shell find . -name '*.thy' | xargs -n 1 realpath --relative-to $(HOME)) ; do \
	java -jar ../jars/isabellesal.jar $$file ;\
	done
	cd coin-tea;\
	bash test_coin_tea.sh;\
	cd ../drinks;\
	bash test_drinks_machine.sh;\
	cd ../lift-controller;\
	sed -i 's/r__4 = None/r__4 = Some(Num(1))/' lift_controller.sal;\
	sed -i 's/r__4 = None/r__4 = Some(Num(1))/' lift_controller_ltl.sal;\
	bash test_lift_controller.sh;\
	cd ../linkedin;\
	bash test_linked_in.sh

testdot:
	# we need the file path relative to $HOME since this is how the translator works
	for file in $(shell find . -name '*.dot' | xargs -n 1 realpath --relative-to $(HOME)) ; do \
	java -jar ../jars/dottoisabelle.jar $$file ;\
	done ;\
	find . -name '*.dot' | xargs -n 1 dot -Tpng -O

testsalisabelle:
	# we need the file path relative to $HOME since this is how the translator works
	for file in $(shell find . -name '*.sal' | xargs -n 1 realpath --relative-to $(HOME)) ; do \
	java -jar ../jars/salisabelle.jar $$file ;\
	done

dot:
	find . -name '*.dot' | xargs -n 1 dot -Tpng -O
