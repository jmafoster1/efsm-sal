%
\begin{isabellebody}%
\setisabellecontext{EFSM}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Extended Finite State Machines%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This theory defines extended finite state machines. Each EFSM takes a type variable which represents
$S$. This is a slight devaition from the definition presented in \cite{foster2018} as this
type variable may be of an infinite type such as integers, however the intended use is for custom
finite types. See the examples for details.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ EFSM\isanewline
\ \ \isakeyword{imports}\ {\isachardoublequoteopen}{\isachartilde}{\isachartilde}{\isacharslash}src{\isacharslash}HOL{\isacharslash}Library{\isacharslash}FSet{\isachardoublequoteclose}\ Transition\ FSet{\isacharunderscore}Utils\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ One{\isacharunderscore}nat{\isacharunderscore}def\ {\isacharbrackleft}simp\ del{\isacharbrackright}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ cfstate\ {\isacharequal}\ nat\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ inputs\ {\isacharequal}\ {\isachardoublequoteopen}value\ list{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ outputs\ {\isacharequal}\ {\isachardoublequoteopen}value\ option\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ event\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}label\ {\isasymtimes}\ inputs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ trace\ {\isacharequal}\ {\isachardoublequoteopen}event\ list{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ observation\ {\isacharequal}\ {\isachardoublequoteopen}outputs\ list{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ transition{\isacharunderscore}matrix\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharparenleft}nat\ {\isasymtimes}\ nat{\isacharparenright}\ {\isasymtimes}\ transition{\isacharparenright}\ fset{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Str\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}string\ {\isasymRightarrow}\ value{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}Str\ s\ {\isasymequiv}\ value{\isachardot}Str\ {\isacharparenleft}String{\isachardot}implode\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ str{\isacharunderscore}not{\isacharunderscore}num{\isacharcolon}\ {\isachardoublequoteopen}Str\ s\ {\isasymnoteq}\ Num\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Str{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ S\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ fset{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}S\ m\ {\isacharequal}\ {\isacharparenleft}fimage\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ s{\isacharprime}{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ s{\isacharparenright}\ m{\isacharparenright}\ {\isacharbar}{\isasymunion}{\isacharbar}\ fimage\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ s{\isacharprime}{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ s{\isacharprime}{\isacharparenright}\ m{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ apply{\isacharunderscore}outputs\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}aexp\ list\ {\isasymRightarrow}\ datastate\ {\isasymRightarrow}\ value\ option\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}outputs\ p\ s\ {\isacharequal}\ map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ aval\ p\ s{\isacharparenright}\ p{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ apply{\isacharunderscore}outputs\ {\isacharequal}\ datastate\ apply{\isacharunderscore}outputs{\isacharunderscore}def\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}apply{\isacharunderscore}outputs\ {\isacharbrackleft}{\isacharbrackright}\ s\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}apply{\isacharunderscore}outputs\ p\ s{\isacharparenright}\ {\isacharequal}\ length\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ apply{\isacharunderscore}guards\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}gexp\ list\ {\isasymRightarrow}\ datastate\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}guards\ G\ s\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}g\ {\isasymin}\ set\ {\isacharparenleft}map\ {\isacharparenleft}{\isasymlambda}g{\isachardot}\ gval\ g\ s{\isacharparenright}\ G{\isacharparenright}{\isachardot}\ g\ {\isacharequal}\ true{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ apply{\isacharunderscore}guards\ {\isacharequal}\ datastate\ apply{\isacharunderscore}guards{\isacharunderscore}def\ gval{\isachardot}simps\ ValueEq{\isacharunderscore}def\ ValueGt{\isacharunderscore}def\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}guards{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}apply{\isacharunderscore}guards\ {\isacharbrackleft}{\isacharbrackright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}guards{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}guards{\isacharunderscore}cons{\isacharcolon}\ {\isachardoublequoteopen}apply{\isacharunderscore}guards\ {\isacharparenleft}a\ {\isacharhash}\ G{\isacharparenright}\ c\ {\isacharequal}\ {\isacharparenleft}gval\ a\ c\ {\isacharequal}\ true\ {\isasymand}\ apply{\isacharunderscore}guards\ G\ c{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}guards{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}guards{\isacharunderscore}fold{\isacharcolon}\ {\isachardoublequoteopen}apply{\isacharunderscore}guards\ G\ s\ {\isacharequal}\ {\isacharparenleft}gval\ {\isacharparenleft}foldr\ gAnd\ G\ {\isacharparenleft}Bc\ True{\isacharparenright}{\isacharparenright}\ s\ {\isacharequal}\ true{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ G{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}guards{\isacharunderscore}def\ gval{\isachardot}simps{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ G{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ foldr{\isachardot}simps\ comp{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}guards{\isacharunderscore}cons\ gval{\isacharunderscore}gAnd\ maybe{\isacharunderscore}and{\isacharunderscore}true{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}apply{\isacharunderscore}guards{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}gval\ {\isacharparenleft}foldr\ gAnd\ G\ {\isacharparenleft}Bc\ True{\isacharparenright}{\isacharparenright}\ s\ {\isacharequal}\ true{\isacharparenright}\ {\isacharequal}\ apply{\isacharunderscore}guards\ G\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}guards{\isacharunderscore}fold{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}guards{\isacharunderscore}subset{\isacharcolon}\ {\isachardoublequoteopen}set\ g{\isacharprime}\ {\isasymsubseteq}\ set\ g\ {\isasymLongrightarrow}\ apply{\isacharunderscore}guards\ g\ c\ {\isasymlongrightarrow}\ apply{\isacharunderscore}guards\ g{\isacharprime}\ c{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ g{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ g{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}guards{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ apply{\isacharunderscore}updates\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}updates\ {\isasymRightarrow}\ datastate\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ registers{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}updates\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharunderscore}\ new\ {\isacharequal}\ new{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}updates\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ old\ new\ {\isacharequal}\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ if\ x\ {\isacharequal}\ {\isacharparenleft}fst\ h{\isacharparenright}\ then\ {\isacharparenleft}aval\ {\isacharparenleft}snd\ h{\isacharparenright}\ old{\isacharparenright}\ else\ {\isacharparenleft}apply{\isacharunderscore}updates\ t\ old\ new{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ r{\isacharunderscore}not{\isacharunderscore}updated{\isacharunderscore}stays{\isacharunderscore}the{\isacharunderscore}same{\isacharcolon}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ fst\ {\isacharbackquote}\ set\ U\ {\isasymLongrightarrow}\isanewline
\ \ \ \ apply{\isacharunderscore}updates\ U\ c\ d\ r\ {\isacharequal}\ d\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ U{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ U{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ possible{\isacharunderscore}steps\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ label\ {\isasymRightarrow}\ inputs\ {\isasymRightarrow}\ {\isacharparenleft}nat\ {\isasymtimes}\ transition{\isacharparenright}\ fset{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ fimage\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ {\isacharparenleft}dest{\isacharcomma}\ t{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isacharcomma}\ t{\isacharcolon}{\isacharcolon}transition{\isacharparenright}{\isachardot}\ origin\ {\isacharequal}\ s\ {\isasymand}\ {\isacharparenleft}Label\ t{\isacharparenright}\ {\isacharequal}\ l\ {\isasymand}\ {\isacharparenleft}length\ i{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Arity\ t{\isacharparenright}\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}alt{\isacharunderscore}aux{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ {\isacharparenleft}dest{\isacharcomma}\ t{\isacharparenright}{\isacharparenright}\ {\isacharbar}{\isacharbackquote}{\isacharbar}\isanewline
\ \ \ \ ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ origin\ {\isacharequal}\ s\ {\isasymand}\ Label\ t\ {\isacharequal}\ l\ {\isasymand}\ length\ i\ {\isacharequal}\ Arity\ t\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}\ e\ {\isacharequal}\isanewline
\ \ \ \ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}d{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ ffilter\isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ origin\ {\isacharequal}\ s\ {\isasymand}\ Label\ t\ {\isacharequal}\ l\ {\isasymand}\ length\ i\ {\isacharequal}\ Arity\ t\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ case\ x\ of\ vname{\isachardot}I\ n\ {\isasymRightarrow}\ input{\isadigit{2}}state\ i\ n\ {\isacharbar}\ R\ n\ {\isasymRightarrow}\ r\ n{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ e\ {\isacharequal}\isanewline
\ \ \ \ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ d{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ e{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ empty\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ffilter{\isacharunderscore}empty{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}insert\ x\ e{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ffilter{\isacharunderscore}finsert\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}aa\ {\isacharequal}\ s{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}Label\ ba\ {\isacharequal}\ l{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}length\ i\ {\isacharequal}\ Arity\ ba{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ ba{\isacharparenright}\ {\isacharparenleft}case{\isacharunderscore}vname\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ input{\isadigit{2}}state\ i\ n{\isacharparenright}\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ r\ n{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}alt{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}d{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}ffilter\isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ origin\ {\isacharequal}\ s\ {\isasymand}\ Label\ t\ {\isacharequal}\ l\ {\isasymand}\ length\ i\ {\isacharequal}\ Arity\ t\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ case\ x\ of\ vname{\isachardot}I\ n\ {\isasymRightarrow}\ input{\isadigit{2}}state\ i\ n\ {\isacharbar}\ R\ n\ {\isasymRightarrow}\ r\ n{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ e\ {\isacharequal}\isanewline
\ \ \ \ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ d{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ standard\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ possible{\isacharunderscore}steps{\isacharunderscore}alt{\isacharunderscore}aux{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ singleton{\isacharunderscore}dest{\isacharcolon}\ {\isachardoublequoteopen}fis{\isacharunderscore}singleton\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ b{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ fthe{\isacharunderscore}elem\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}baa{\isacharcomma}\ aba{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ baa{\isacharparenright}{\isacharcomma}\ aba{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ fis{\isacharunderscore}singleton{\isacharunderscore}def\ fthe{\isacharunderscore}elem{\isacharunderscore}def\ singleton{\isacharunderscore}equiv{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ fmember{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ ffilter\ {\isacharequal}\ ffilter{\isacharunderscore}def\ fset{\isacharunderscore}both{\isacharunderscore}sides\ Abs{\isacharunderscore}fset{\isacharunderscore}inverse\ Set{\isachardot}filter{\isacharunderscore}def\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}singleton\ {\isacharequal}\ ffilter\ possible{\isacharunderscore}steps{\isacharunderscore}alt\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}empty\ {\isacharequal}\ ffilter\ possible{\isacharunderscore}steps{\isacharunderscore}def\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ step\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ cfstate\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ label\ {\isasymRightarrow}\ inputs\ {\isasymRightarrow}\ {\isacharparenleft}transition\ {\isasymtimes}\ nat\ {\isasymtimes}\ outputs\ {\isasymtimes}\ registers{\isacharparenright}\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
{\isachardoublequoteopen}step\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharparenleft}let\ possibilities\ {\isacharequal}\ possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if\ possibilities\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ then\ None\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ let\ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}\ {\isacharequal}\ Eps\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isacharbar}{\isasymin}{\isacharbar}\ possibilities{\isacharparenright}\ in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ {\isacharparenleft}apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}{\isacharcomma}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ no{\isacharunderscore}possible{\isacharunderscore}steps{\isacharcolon}\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\ step\ e\ s\ r\ l\ i\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ one{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ {\isacharequal}\ p\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r\ {\isacharequal}\ u\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ step\ e\ s\ r\ l\ i\ {\isacharequal}\ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharcomma}\ u{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}empty{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}{\isachardoublequoteopen}step\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ s\ r\ l\ i\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def\ possible{\isacharunderscore}steps{\isacharunderscore}def\ ffilter{\isacharunderscore}empty{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ observe{\isacharunderscore}all\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ {\isacharparenleft}transition\ {\isasymtimes}\ nat\ {\isasymtimes}\ outputs\ {\isasymtimes}\ registers{\isacharparenright}\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}observe{\isacharunderscore}all\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}observe{\isacharunderscore}all\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isacharequal}\isanewline
\ \ \ \ {\isacharparenleft}case\ {\isacharparenleft}step\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isacharparenright}\ of\isanewline
\ \ \ \ \ \ {\isacharparenleft}Some\ {\isacharparenleft}transition{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ outputs{\isacharcomma}\ updated{\isacharparenright}{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharparenleft}{\isacharparenleft}transition{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ outputs{\isacharcomma}\ updated{\isacharparenright}{\isacharhash}{\isacharparenleft}observe{\isacharunderscore}all\ e\ s{\isacharprime}\ updated\ t{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharbar}\isanewline
\ \ \ \ \ \ {\isacharunderscore}\ {\isasymRightarrow}\ {\isacharbrackleft}{\isacharbrackright}\isanewline
\ \ \ \ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}transition\ {\isasymtimes}\ nat\ {\isasymtimes}\ outputs\ {\isasymtimes}\ datastate{\isacharparenright}\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}state\ x\ {\isasymequiv}\ fst\ {\isacharparenleft}snd\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ observe{\isacharunderscore}trace\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ observation{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}observe{\isacharunderscore}trace\ e\ s\ r\ t\ {\isasymequiv}\ map\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}t{\isacharcomma}x{\isacharcomma}y{\isacharcomma}z{\isacharparenright}{\isachardot}\ y{\isacharparenright}\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}observe{\isacharunderscore}trace\ e\ s\ r\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}\isanewline
\ \ \ \ \ \ \ step\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharcomma}\ r{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ observe{\isacharunderscore}trace\ e\ s{\isacharprime}\ r{\isacharprime}\ es\ {\isacharequal}\ obs\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ observe{\isacharunderscore}trace\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}es{\isacharparenright}\ {\isacharequal}\ p{\isacharhash}obs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isacharparenright}\ {\isacharequal}\ p\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isacharparenright}\ r\ {\isacharequal}\ r{\isacharprime}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ observe{\isacharunderscore}trace\ e\ s{\isacharprime}\ r{\isacharprime}\ es\ {\isacharequal}\ obs\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ observe{\isacharunderscore}trace\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}es{\isacharparenright}\ {\isacharequal}\ p{\isacharhash}obs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}step\ one{\isacharunderscore}possible{\isacharunderscore}step\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ observe{\isacharunderscore}trace\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}es{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def\ step{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}empty{\isacharcolon}\ {\isachardoublequoteopen}t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ observe{\isacharunderscore}trace\ e\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ efsm{\isacharunderscore}equiv\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}efsm{\isacharunderscore}equiv\ e{\isadigit{1}}\ e{\isadigit{2}}\ t\ {\isasymequiv}\ {\isacharparenleft}{\isacharparenleft}observe{\isacharunderscore}trace\ e{\isadigit{1}}\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ t{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}observe{\isacharunderscore}trace\ e{\isadigit{2}}\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ efsm{\isacharunderscore}equiv{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e{\isadigit{1}}\ s{\isadigit{1}}\ r{\isadigit{1}}\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isadigit{1}}{\isacharprime}{\isacharcomma}\ t{\isadigit{1}}{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ possible{\isacharunderscore}steps\ e{\isadigit{2}}\ s{\isadigit{2}}\ r{\isadigit{2}}\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isadigit{2}}{\isacharprime}{\isacharcomma}\ t{\isadigit{2}}{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isadigit{2}}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isadigit{2}}{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isadigit{1}}{\isacharparenright}\ r{\isadigit{1}}\ {\isacharequal}\ r{\isadigit{1}}{\isacharprime}\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isadigit{2}}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isadigit{2}}{\isacharparenright}\ r{\isadigit{2}}\ {\isacharequal}\ r{\isadigit{2}}{\isacharprime}\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e{\isadigit{1}}\ s{\isadigit{1}}{\isacharprime}\ r{\isadigit{1}}{\isacharprime}\ t\ {\isacharequal}\ observe{\isacharunderscore}trace\ e{\isadigit{2}}\ s{\isadigit{2}}{\isacharprime}\ r{\isadigit{2}}{\isacharprime}\ t\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e{\isadigit{1}}\ s{\isadigit{1}}\ r{\isadigit{1}}\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isacharequal}\ observe{\isacharunderscore}trace\ e{\isadigit{2}}\ s{\isadigit{2}}\ r{\isadigit{2}}\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}possible{\isacharunderscore}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ efsm{\isacharunderscore}equiv{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e{\isadigit{1}}\ s{\isadigit{1}}\ r{\isadigit{1}}\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ possible{\isacharunderscore}steps\ e{\isadigit{2}}\ s{\isadigit{2}}\ r{\isadigit{2}}\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e{\isadigit{1}}\ s{\isadigit{1}}\ r{\isadigit{1}}\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isacharequal}\ observe{\isacharunderscore}trace\ e{\isadigit{2}}\ s{\isadigit{2}}\ r{\isadigit{2}}\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ efsm{\isacharunderscore}equiv{\isacharunderscore}reflexive{\isacharcolon}\ {\isachardoublequoteopen}efsm{\isacharunderscore}equiv\ e{\isadigit{1}}\ e{\isadigit{1}}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ efsm{\isacharunderscore}equiv{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ efsm{\isacharunderscore}equiv{\isacharunderscore}symmetric{\isacharcolon}\ {\isachardoublequoteopen}efsm{\isacharunderscore}equiv\ e{\isadigit{1}}\ e{\isadigit{2}}\ t\ {\isasymequiv}\ efsm{\isacharunderscore}equiv\ e{\isadigit{2}}\ e{\isadigit{1}}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ efsm{\isacharunderscore}equiv{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ argo%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ efsm{\isacharunderscore}equiv{\isacharunderscore}transitive{\isacharcolon}\ {\isachardoublequoteopen}efsm{\isacharunderscore}equiv\ e{\isadigit{1}}\ e{\isadigit{2}}\ t\ {\isasymand}\ efsm{\isacharunderscore}equiv\ e{\isadigit{2}}\ e{\isadigit{3}}\ t\ {\isasymlongrightarrow}\ efsm{\isacharunderscore}equiv\ e{\isadigit{1}}\ e{\isadigit{3}}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ efsm{\isacharunderscore}equiv{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ observations\ {\isacharequal}\ observe{\isacharunderscore}trace{\isacharunderscore}def\ step{\isacharunderscore}def\ possible{\isacharunderscore}steps{\isacharunderscore}def\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ different{\isacharunderscore}observation{\isacharunderscore}techniques{\isacharcolon}\ {\isachardoublequoteopen}length{\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ t{\isacharparenright}\ {\isacharequal}\ length{\isacharparenleft}observe{\isacharunderscore}trace\ e\ s\ r\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ length{\isacharunderscore}observe{\isacharunderscore}all{\isacharunderscore}restricted{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}s\ r{\isachardot}\ length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ t{\isacharparenright}\ {\isasymle}\ length\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ t{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ t{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ cases\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}step\ e\ s\ r\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}step\ e\ s\ r\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}\ {\isasymnoteq}\ \ None{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ Cons\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{inductive}\isamarkupfalse%
\ accepts\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ base{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ step{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}tr{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharprime}{\isacharcomma}\ d{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\ accepts\ e\ s{\isacharprime}\ d{\isacharprime}\ t\ {\isasymLongrightarrow}\ accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ accepts{\isacharunderscore}trace\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}accepts{\isacharunderscore}trace\ e\ t\ {\isasymequiv}\ accepts\ e\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ t{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ no{\isacharunderscore}step{\isacharunderscore}none{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ r\ aa\ ba\ {\isacharequal}\ None\ {\isasymLongrightarrow}\ {\isasymnot}accepts\ e\ s\ r\ {\isacharparenleft}{\isacharparenleft}aa{\isacharcomma}\ ba{\isacharparenright}\ {\isacharhash}\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inaccepts{\isacharunderscore}conditions{\isacharcolon}\ {\isachardoublequoteopen}{\isasymnot}accepts\ e\ s\ d\ {\isacharparenleft}h\ {\isacharhash}\ t{\isacharparenright}\ {\isasymLongrightarrow}\ step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ None\ {\isasymor}\ {\isacharparenleft}{\isasymexists}tr\ s{\isacharprime}\ p{\isacharprime}\ d{\isacharprime}{\isachardot}\ step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ \ Some\ {\isacharparenleft}tr{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharprime}{\isacharcomma}\ d{\isacharprime}{\isacharparenright}\ {\isasymand}\ {\isasymnot}accepts\ e\ s{\isacharprime}\ d{\isacharprime}\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ accepts{\isachardot}base\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\isadigit{1}}{\isacharbrackright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ option{\isachardot}exhaust\ prod{\isacharunderscore}cases{\isadigit{4}}\ accepts{\isachardot}step{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}none{\isacharunderscore}inaccepts{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharparenleft}step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ None{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
{\isacharparenleft}clarify{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ rule{\isacharcolon}accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}simp{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inaccepts{\isacharunderscore}future{\isacharunderscore}inaccepts{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymexists}tr\ s{\isacharprime}\ p{\isacharprime}\ d{\isacharprime}{\isachardot}\ step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ \ Some\ {\isacharparenleft}tr{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharprime}{\isacharcomma}\ d{\isacharprime}{\isacharparenright}\ {\isasymand}\ {\isasymnot}accepts\ e\ s{\isacharprime}\ d{\isacharprime}\ t{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymnot}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ rule{\isacharcolon}\ accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ conditions{\isacharunderscore}inaccepts{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ None\ {\isasymor}\ {\isacharparenleft}{\isasymexists}tr\ s{\isacharprime}\ p{\isacharprime}\ d{\isacharprime}{\isachardot}\ step\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ \ Some\ {\isacharparenleft}tr{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharprime}{\isacharcomma}\ d{\isacharprime}{\isacharparenright}\ {\isasymand}\ {\isasymnot}accepts\ e\ s{\isacharprime}\ d{\isacharprime}\ t{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymnot}\ accepts\ e\ s\ d\ {\isacharparenleft}h\ {\isacharhash}\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
{\isacharparenleft}cases\ rule{\isacharcolon}accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}head{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isasymLongrightarrow}\ accepts\ e\ s\ d\ {\isacharbrackleft}h{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}meson\ base\ conditions{\isacharunderscore}inaccepts\ inaccepts{\isacharunderscore}conditions{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inaccepts{\isacharunderscore}single{\isacharunderscore}event{\isacharcolon}\ {\isachardoublequoteopen}{\isasymnot}\ accepts\ e\ s\ d\ {\isacharbrackleft}{\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharbrackright}\ {\isasymLongrightarrow}\ step\ e\ s\ d\ {\isacharparenleft}fst\ {\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}snd\ {\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ base\ inaccepts{\isacharunderscore}conditions{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}inaccepts{\isacharcolon}\ {\isachardoublequoteopen}{\isasymnot}\ accepts\ e\ s\ d\ {\isacharparenleft}{\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}\ {\isacharhash}\ t{\isacharparenright}\ {\isasymLongrightarrow}\ step\ e\ s\ d\ {\isacharparenleft}fst\ {\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}snd\ {\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}tr{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharprime}{\isacharcomma}\ d{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymnot}\ accepts\ e\ s{\isacharprime}\ d{\isacharprime}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ inaccepts{\isacharunderscore}conditions\ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}none{\isacharunderscore}inaccepts{\isacharunderscore}append{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}\ {\isacharequal}\ None\ {\isasymLongrightarrow}\ {\isasymnot}accepts\ e\ s\ d\ {\isacharparenleft}a\ {\isacharhash}\ t{\isacharparenright}\ {\isasymand}\ {\isasymnot}accepts\ e\ s\ d\ {\isacharparenleft}a\ {\isacharhash}\ t\ {\isacharat}\ t{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}none{\isacharunderscore}inaccepts{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}some{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}tr{\isacharcomma}\ aa{\isacharcomma}\ ab{\isacharcomma}\ b{\isacharparenright}\ {\isasymLongrightarrow}\ accepts\ e\ s\ d\ {\isacharparenleft}a\ {\isacharhash}\ t{\isacharparenright}\ {\isacharequal}\ accepts\ e\ aa\ b\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ conditions{\isacharunderscore}inaccepts\ \isacommand{apply}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isachardot}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ aux{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}\ s\ d{\isachardot}\ accepts\ e\ s\ d\ {\isacharparenleft}t{\isacharat}t{\isacharprime}{\isacharparenright}\ {\isasymlongrightarrow}\ accepts\ e\ s\ d\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ t{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ base{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ t{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}\ {\isacharequal}\ None{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}none{\isacharunderscore}inaccepts{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}some{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prefix{\isacharunderscore}closure{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}t{\isacharat}t{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\ accepts\ e\ s\ d\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ {\isachardoublequoteopen}t{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ base{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ x\ xs{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ x{\isacharparenright}\ {\isacharparenleft}snd\ x{\isacharparenright}\ {\isacharequal}\ None{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}none{\isacharunderscore}inaccepts{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}some{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ aux{\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ inaccepts{\isacharunderscore}prefix{\isacharcolon}\ {\isachardoublequoteopen}{\isasymnot}accepts\ e\ s\ d\ t\ {\isasymLongrightarrow}\ {\isasymnot}accepts\ e\ s\ d\ {\isacharparenleft}t{\isacharat}t{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ ccontr{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ prefix{\isacharunderscore}closure{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ length{\isacharunderscore}observe{\isacharunderscore}empty{\isacharunderscore}trace{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ aa\ b\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}length{\isacharunderscore}suc{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}tr{\isacharcomma}\ aa{\isacharcomma}\ ab{\isacharcomma}\ b{\isacharparenright}\ {\isasymLongrightarrow}\ length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ {\isacharparenleft}a\ {\isacharhash}\ t{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ Suc\ {\isacharparenleft}length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ aa\ b\ t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}trace{\isacharunderscore}obs{\isacharunderscore}equal{\isacharunderscore}length{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}r\ s{\isachardot}\ accepts\ e\ s\ r\ t\ {\isasymlongrightarrow}\ {\isacharparenleft}length\ t\ {\isacharequal}\ length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ t{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ t{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}step\ e\ s\ r\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}none{\isacharunderscore}inaccepts{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ aa{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ step{\isacharunderscore}some\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ aux{\isadigit{3}}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}s\ d{\isachardot}\ {\isacharparenleft}length\ t\ {\isacharequal}\ length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ d\ t{\isacharparenright}{\isacharparenright}\ {\isasymlongrightarrow}\ accepts\ e\ s\ d\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ t{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isachardot}base{\isacharparenright}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ t{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}step\ e\ s\ d\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ aa{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ only{\isacharcolon}\ step{\isacharunderscore}length{\isacharunderscore}suc\ step{\isacharunderscore}some{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{inductive}\isamarkupfalse%
\ gets{\isacharunderscore}us{\isacharunderscore}to\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ base{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isacharequal}\ target\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ {\isacharunderscore}\ s\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ step{\isacharunderscore}some{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ \ Some\ {\isacharparenleft}{\isacharunderscore}{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ {\isacharunderscore}{\isacharcomma}\ r{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ e\ s{\isacharprime}\ r{\isacharprime}\ t\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ step{\isacharunderscore}none{\isacharcolon}\ {\isachardoublequoteopen}step\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ None\ {\isasymLongrightarrow}\ s\ {\isacharequal}\ target\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ no{\isacharunderscore}further{\isacharunderscore}steps{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ s{\isacharprime}\ {\isasymLongrightarrow}\ {\isasymnot}\ gets{\isacharunderscore}us{\isacharunderscore}to\ s\ e\ s{\isacharprime}\ r\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ gets{\isacharunderscore}us{\isacharunderscore}to{\isachardot}cases{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ incoming{\isacharunderscore}transition{\isacharunderscore}to\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}incoming{\isacharunderscore}transition{\isacharunderscore}to\ t\ s\ {\isacharequal}\ {\isacharparenleft}{\isacharparenleft}ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}from{\isacharcomma}\ to{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ to\ {\isacharequal}\ s{\isacharparenright}\ t{\isacharparenright}\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ incoming{\isacharunderscore}transition{\isacharunderscore}alt{\isacharunderscore}def{\isacharcolon}\ {\isachardoublequoteopen}incoming{\isacharunderscore}transition{\isacharunderscore}to\ e\ n\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}t\ from{\isachardot}\ {\isacharparenleft}{\isacharparenleft}from{\isacharcomma}\ n{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ incoming{\isacharunderscore}transition{\isacharunderscore}to{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ffilter{\isacharunderscore}def\ fset{\isacharunderscore}both{\isacharunderscore}sides\ Abs{\isacharunderscore}fset{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ fmember{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Set{\isachardot}filter{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/efsm-sal/theories/EFSM.thy%:%
%:%11=1%:%
%:%23=3%:%
%:%24=4%:%
%:%25=5%:%
%:%26=6%:%
%:%34=9%:%
%:%35=9%:%
%:%36=10%:%
%:%37=11%:%
%:%44=11%:%
%:%45=12%:%
%:%46=13%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=15%:%
%:%51=16%:%
%:%52=16%:%
%:%53=17%:%
%:%54=17%:%
%:%55=18%:%
%:%56=19%:%
%:%57=19%:%
%:%58=20%:%
%:%59=20%:%
%:%60=21%:%
%:%61=21%:%
%:%62=22%:%
%:%63=22%:%
%:%64=23%:%
%:%65=24%:%
%:%66=24%:%
%:%67=25%:%
%:%68=26%:%
%:%69=27%:%
%:%70=27%:%
%:%73=28%:%
%:%77=28%:%
%:%78=28%:%
%:%83=28%:%
%:%86=29%:%
%:%87=30%:%
%:%88=30%:%
%:%89=31%:%
%:%90=32%:%
%:%91=33%:%
%:%92=33%:%
%:%93=34%:%
%:%94=35%:%
%:%95=36%:%
%:%96=36%:%
%:%97=37%:%
%:%98=38%:%
%:%99=38%:%
%:%102=39%:%
%:%106=39%:%
%:%107=39%:%
%:%112=39%:%
%:%115=40%:%
%:%116=41%:%
%:%117=41%:%
%:%120=42%:%
%:%124=42%:%
%:%125=42%:%
%:%130=42%:%
%:%133=43%:%
%:%134=44%:%
%:%135=44%:%
%:%136=45%:%
%:%137=46%:%
%:%138=47%:%
%:%139=47%:%
%:%140=48%:%
%:%141=49%:%
%:%142=49%:%
%:%145=50%:%
%:%149=50%:%
%:%150=50%:%
%:%155=50%:%
%:%158=51%:%
%:%159=52%:%
%:%160=52%:%
%:%163=53%:%
%:%167=53%:%
%:%168=53%:%
%:%173=53%:%
%:%176=54%:%
%:%177=55%:%
%:%178=55%:%
%:%185=56%:%
%:%186=56%:%
%:%187=57%:%
%:%188=57%:%
%:%189=58%:%
%:%190=58%:%
%:%191=58%:%
%:%192=59%:%
%:%193=59%:%
%:%194=60%:%
%:%195=60%:%
%:%196=61%:%
%:%197=61%:%
%:%198=62%:%
%:%199=62%:%
%:%200=62%:%
%:%201=63%:%
%:%202=63%:%
%:%203=64%:%
%:%204=64%:%
%:%205=65%:%
%:%211=65%:%
%:%214=66%:%
%:%215=67%:%
%:%216=67%:%
%:%219=68%:%
%:%223=68%:%
%:%224=68%:%
%:%229=68%:%
%:%232=69%:%
%:%233=70%:%
%:%234=70%:%
%:%241=71%:%
%:%242=71%:%
%:%243=72%:%
%:%244=72%:%
%:%245=73%:%
%:%246=73%:%
%:%247=73%:%
%:%248=74%:%
%:%249=74%:%
%:%250=75%:%
%:%251=75%:%
%:%252=76%:%
%:%253=76%:%
%:%254=77%:%
%:%255=77%:%
%:%256=77%:%
%:%257=78%:%
%:%258=78%:%
%:%259=79%:%
%:%260=79%:%
%:%261=80%:%
%:%267=80%:%
%:%270=81%:%
%:%271=82%:%
%:%272=82%:%
%:%273=83%:%
%:%274=84%:%
%:%275=85%:%
%:%276=86%:%
%:%277=86%:%
%:%278=87%:%
%:%285=88%:%
%:%286=88%:%
%:%287=89%:%
%:%288=89%:%
%:%289=90%:%
%:%290=90%:%
%:%291=90%:%
%:%292=91%:%
%:%293=91%:%
%:%294=92%:%
%:%295=92%:%
%:%296=93%:%
%:%297=93%:%
%:%298=94%:%
%:%299=94%:%
%:%300=94%:%
%:%301=95%:%
%:%302=95%:%
%:%303=96%:%
%:%309=96%:%
%:%312=97%:%
%:%313=98%:%
%:%314=98%:%
%:%315=99%:%
%:%316=100%:%
%:%317=101%:%
%:%318=101%:%
%:%325=108%:%
%:%332=109%:%
%:%333=109%:%
%:%334=110%:%
%:%335=110%:%
%:%336=111%:%
%:%337=111%:%
%:%338=111%:%
%:%339=112%:%
%:%340=112%:%
%:%341=113%:%
%:%342=113%:%
%:%343=114%:%
%:%344=114%:%
%:%345=115%:%
%:%346=115%:%
%:%347=116%:%
%:%348=116%:%
%:%349=116%:%
%:%350=117%:%
%:%351=117%:%
%:%352=118%:%
%:%353=118%:%
%:%354=119%:%
%:%355=119%:%
%:%356=120%:%
%:%357=120%:%
%:%358=121%:%
%:%359=121%:%
%:%360=122%:%
%:%361=122%:%
%:%362=123%:%
%:%363=123%:%
%:%364=124%:%
%:%365=124%:%
%:%366=125%:%
%:%367=125%:%
%:%368=126%:%
%:%369=126%:%
%:%370=127%:%
%:%371=127%:%
%:%372=128%:%
%:%373=128%:%
%:%374=129%:%
%:%375=129%:%
%:%376=130%:%
%:%382=130%:%
%:%385=131%:%
%:%386=132%:%
%:%387=132%:%
%:%391=136%:%
%:%394=137%:%
%:%398=137%:%
%:%399=137%:%
%:%400=138%:%
%:%401=138%:%
%:%402=139%:%
%:%403=139%:%
%:%408=139%:%
%:%411=140%:%
%:%412=141%:%
%:%413=141%:%
%:%415=143%:%
%:%418=144%:%
%:%422=144%:%
%:%423=144%:%
%:%424=145%:%
%:%425=145%:%
%:%426=146%:%
%:%427=146%:%
%:%432=146%:%
%:%435=147%:%
%:%436=148%:%
%:%437=148%:%
%:%438=149%:%
%:%439=149%:%
%:%440=150%:%
%:%441=150%:%
%:%442=151%:%
%:%443=152%:%
%:%444=152%:%
%:%445=153%:%
%:%450=158%:%
%:%451=159%:%
%:%452=160%:%
%:%453=160%:%
%:%456=161%:%
%:%460=161%:%
%:%461=161%:%
%:%466=161%:%
%:%469=162%:%
%:%470=163%:%
%:%471=163%:%
%:%474=166%:%
%:%477=167%:%
%:%481=167%:%
%:%482=167%:%
%:%487=167%:%
%:%490=168%:%
%:%491=169%:%
%:%492=169%:%
%:%495=170%:%
%:%499=170%:%
%:%500=170%:%
%:%505=170%:%
%:%508=171%:%
%:%509=172%:%
%:%510=172%:%
%:%511=173%:%
%:%512=174%:%
%:%516=178%:%
%:%517=179%:%
%:%518=180%:%
%:%519=180%:%
%:%520=181%:%
%:%521=182%:%
%:%522=183%:%
%:%523=183%:%
%:%524=184%:%
%:%525=185%:%
%:%526=186%:%
%:%527=186%:%
%:%530=187%:%
%:%534=187%:%
%:%535=187%:%
%:%540=187%:%
%:%543=188%:%
%:%544=189%:%
%:%545=189%:%
%:%548=192%:%
%:%551=193%:%
%:%555=193%:%
%:%556=193%:%
%:%561=193%:%
%:%564=194%:%
%:%565=195%:%
%:%566=195%:%
%:%570=199%:%
%:%573=200%:%
%:%577=200%:%
%:%578=200%:%
%:%579=201%:%
%:%580=201%:%
%:%585=201%:%
%:%588=202%:%
%:%589=203%:%
%:%590=203%:%
%:%591=204%:%
%:%594=205%:%
%:%598=205%:%
%:%599=205%:%
%:%604=205%:%
%:%607=206%:%
%:%608=207%:%
%:%609=207%:%
%:%612=208%:%
%:%616=208%:%
%:%617=208%:%
%:%622=208%:%
%:%625=209%:%
%:%626=210%:%
%:%627=210%:%
%:%628=211%:%
%:%629=212%:%
%:%630=213%:%
%:%631=213%:%
%:%632=214%:%
%:%638=220%:%
%:%641=221%:%
%:%645=221%:%
%:%646=221%:%
%:%651=221%:%
%:%654=222%:%
%:%655=223%:%
%:%656=223%:%
%:%657=224%:%
%:%659=226%:%
%:%662=227%:%
%:%666=227%:%
%:%667=227%:%
%:%672=227%:%
%:%675=228%:%
%:%676=229%:%
%:%677=229%:%
%:%680=230%:%
%:%684=230%:%
%:%685=230%:%
%:%690=230%:%
%:%693=231%:%
%:%694=232%:%
%:%695=232%:%
%:%698=233%:%
%:%702=233%:%
%:%703=233%:%
%:%704=234%:%
%:%705=234%:%
%:%710=234%:%
%:%713=235%:%
%:%714=236%:%
%:%715=236%:%
%:%718=237%:%
%:%722=237%:%
%:%723=237%:%
%:%728=237%:%
%:%731=238%:%
%:%732=239%:%
%:%733=239%:%
%:%734=240%:%
%:%735=241%:%
%:%736=241%:%
%:%739=242%:%
%:%743=242%:%
%:%744=242%:%
%:%749=242%:%
%:%752=243%:%
%:%753=244%:%
%:%754=244%:%
%:%761=245%:%
%:%762=245%:%
%:%763=246%:%
%:%764=246%:%
%:%765=247%:%
%:%766=247%:%
%:%767=247%:%
%:%768=247%:%
%:%769=248%:%
%:%770=248%:%
%:%771=249%:%
%:%772=249%:%
%:%773=250%:%
%:%774=250%:%
%:%775=250%:%
%:%776=251%:%
%:%777=251%:%
%:%778=252%:%
%:%779=252%:%
%:%780=253%:%
%:%781=253%:%
%:%782=253%:%
%:%783=253%:%
%:%784=254%:%
%:%785=254%:%
%:%786=255%:%
%:%787=255%:%
%:%788=256%:%
%:%789=256%:%
%:%790=256%:%
%:%791=256%:%
%:%792=257%:%
%:%793=257%:%
%:%794=258%:%
%:%800=258%:%
%:%803=259%:%
%:%804=260%:%
%:%805=260%:%
%:%806=261%:%
%:%807=262%:%
%:%808=263%:%
%:%809=264%:%
%:%810=264%:%
%:%811=265%:%
%:%812=266%:%
%:%813=267%:%
%:%814=267%:%
%:%817=268%:%
%:%821=268%:%
%:%822=268%:%
%:%823=269%:%
%:%824=269%:%
%:%825=270%:%
%:%826=270%:%
%:%827=271%:%
%:%828=271%:%
%:%829=272%:%
%:%830=272%:%
%:%835=272%:%
%:%838=273%:%
%:%839=274%:%
%:%840=274%:%
%:%843=275%:%
%:%847=275%:%
%:%848=275%:%
%:%849=276%:%
%:%850=276%:%
%:%851=277%:%
%:%852=277%:%
%:%853=278%:%
%:%854=278%:%
%:%855=279%:%
%:%856=279%:%
%:%861=279%:%
%:%864=280%:%
%:%865=281%:%
%:%866=281%:%
%:%869=282%:%
%:%873=282%:%
%:%874=282%:%
%:%875=283%:%
%:%876=283%:%
%:%877=284%:%
%:%878=284%:%
%:%879=285%:%
%:%880=285%:%
%:%881=286%:%
%:%882=286%:%
%:%887=286%:%
%:%890=287%:%
%:%891=288%:%
%:%892=288%:%
%:%895=289%:%
%:%899=289%:%
%:%900=289%:%
%:%901=290%:%
%:%902=290%:%
%:%903=291%:%
%:%904=291%:%
%:%905=292%:%
%:%906=292%:%
%:%907=293%:%
%:%908=293%:%
%:%913=293%:%
%:%916=294%:%
%:%917=295%:%
%:%918=295%:%
%:%921=296%:%
%:%925=296%:%
%:%926=296%:%
%:%927=297%:%
%:%928=297%:%
%:%929=298%:%
%:%930=298%:%
%:%931=299%:%
%:%932=299%:%
%:%933=300%:%
%:%934=300%:%
%:%939=300%:%
%:%942=301%:%
%:%943=302%:%
%:%944=302%:%
%:%947=303%:%
%:%951=303%:%
%:%952=303%:%
%:%957=303%:%
%:%960=304%:%
%:%961=305%:%
%:%962=305%:%
%:%965=306%:%
%:%969=306%:%
%:%970=306%:%
%:%975=306%:%
%:%978=307%:%
%:%979=308%:%
%:%980=308%:%
%:%983=309%:%
%:%987=309%:%
%:%988=309%:%
%:%989=309%:%
%:%994=309%:%
%:%997=310%:%
%:%998=311%:%
%:%999=311%:%
%:%1002=312%:%
%:%1006=312%:%
%:%1007=312%:%
%:%1012=312%:%
%:%1015=313%:%
%:%1016=314%:%
%:%1017=314%:%
%:%1020=315%:%
%:%1024=315%:%
%:%1025=315%:%
%:%1026=316%:%
%:%1027=316%:%
%:%1028=316%:%
%:%1029=317%:%
%:%1030=317%:%
%:%1035=317%:%
%:%1038=318%:%
%:%1039=319%:%
%:%1040=319%:%
%:%1043=320%:%
%:%1047=320%:%
%:%1048=320%:%
%:%1049=321%:%
%:%1050=321%:%
%:%1051=322%:%
%:%1052=322%:%
%:%1053=322%:%
%:%1054=322%:%
%:%1055=323%:%
%:%1056=323%:%
%:%1057=324%:%
%:%1058=324%:%
%:%1059=325%:%
%:%1060=325%:%
%:%1061=325%:%
%:%1062=326%:%
%:%1063=326%:%
%:%1064=327%:%
%:%1065=327%:%
%:%1066=328%:%
%:%1067=328%:%
%:%1068=329%:%
%:%1069=329%:%
%:%1070=330%:%
%:%1071=330%:%
%:%1072=331%:%
%:%1073=331%:%
%:%1074=332%:%
%:%1080=332%:%
%:%1083=333%:%
%:%1084=334%:%
%:%1085=334%:%
%:%1088=335%:%
%:%1092=335%:%
%:%1093=335%:%
%:%1094=336%:%
%:%1095=336%:%
%:%1096=337%:%
%:%1097=337%:%
%:%1098=337%:%
%:%1099=337%:%
%:%1100=338%:%
%:%1101=338%:%
%:%1102=339%:%
%:%1103=339%:%
%:%1104=340%:%
%:%1105=340%:%
%:%1106=340%:%
%:%1107=341%:%
%:%1108=341%:%
%:%1109=342%:%
%:%1110=342%:%
%:%1111=343%:%
%:%1112=343%:%
%:%1113=344%:%
%:%1114=344%:%
%:%1115=345%:%
%:%1116=345%:%
%:%1117=346%:%
%:%1118=346%:%
%:%1119=346%:%
%:%1120=347%:%
%:%1126=347%:%
%:%1129=348%:%
%:%1130=349%:%
%:%1131=349%:%
%:%1134=350%:%
%:%1138=350%:%
%:%1139=350%:%
%:%1140=351%:%
%:%1141=351%:%
%:%1146=351%:%
%:%1149=352%:%
%:%1150=353%:%
%:%1151=353%:%
%:%1154=354%:%
%:%1158=354%:%
%:%1159=354%:%
%:%1164=354%:%
%:%1167=355%:%
%:%1168=356%:%
%:%1169=356%:%
%:%1172=357%:%
%:%1176=357%:%
%:%1177=357%:%
%:%1182=357%:%
%:%1185=358%:%
%:%1186=359%:%
%:%1187=359%:%
%:%1194=360%:%
%:%1195=360%:%
%:%1196=361%:%
%:%1197=361%:%
%:%1198=362%:%
%:%1199=362%:%
%:%1200=362%:%
%:%1201=363%:%
%:%1202=363%:%
%:%1203=364%:%
%:%1204=364%:%
%:%1205=365%:%
%:%1206=365%:%
%:%1207=366%:%
%:%1208=366%:%
%:%1209=366%:%
%:%1210=367%:%
%:%1211=367%:%
%:%1212=368%:%
%:%1213=368%:%
%:%1214=369%:%
%:%1215=369%:%
%:%1216=370%:%
%:%1217=370%:%
%:%1218=371%:%
%:%1219=371%:%
%:%1220=372%:%
%:%1221=372%:%
%:%1222=373%:%
%:%1223=373%:%
%:%1224=373%:%
%:%1225=374%:%
%:%1231=374%:%
%:%1234=375%:%
%:%1235=376%:%
%:%1236=377%:%
%:%1237=377%:%
%:%1240=378%:%
%:%1244=378%:%
%:%1245=378%:%
%:%1246=379%:%
%:%1247=379%:%
%:%1248=380%:%
%:%1249=380%:%
%:%1250=380%:%
%:%1251=380%:%
%:%1252=381%:%
%:%1253=381%:%
%:%1254=382%:%
%:%1255=382%:%
%:%1256=383%:%
%:%1257=383%:%
%:%1258=383%:%
%:%1259=384%:%
%:%1260=384%:%
%:%1261=385%:%
%:%1262=385%:%
%:%1263=386%:%
%:%1264=386%:%
%:%1265=387%:%
%:%1266=387%:%
%:%1267=388%:%
%:%1268=388%:%
%:%1269=389%:%
%:%1270=389%:%
%:%1271=390%:%
%:%1272=390%:%
%:%1273=391%:%
%:%1274=391%:%
%:%1275=392%:%
%:%1281=392%:%
%:%1284=393%:%
%:%1285=394%:%
%:%1286=394%:%
%:%1287=395%:%
%:%1288=396%:%
%:%1289=397%:%
%:%1290=398%:%
%:%1291=399%:%
%:%1292=399%:%
%:%1295=400%:%
%:%1299=400%:%
%:%1300=400%:%
%:%1301=401%:%
%:%1302=401%:%
%:%1303=402%:%
%:%1304=402%:%
%:%1309=402%:%
%:%1312=403%:%
%:%1313=404%:%
%:%1314=404%:%
%:%1315=405%:%
%:%1316=406%:%
%:%1317=407%:%
%:%1318=407%:%
%:%1321=408%:%
%:%1325=408%:%
%:%1326=408%:%
%:%1327=409%:%
%:%1328=409%:%
%:%1329=410%:%
%:%1330=410%:%
%:%1331=411%:%
%:%1332=411%:%
%:%1333=412%:%
%:%1334=412%:%
%:%1339=412%:%
%:%1344=413%:%
%:%1349=414%:%