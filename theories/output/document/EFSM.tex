%
\begin{isabellebody}%
\setisabellecontext{EFSM}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Extended Finite State Machines%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This theory defines extended finite state machines. Each EFSM takes a type variable which represents
$S$. This is a slight devaition from the definition presented in \cite{foster2018} as this
type variable may be of an infinite type such as integers, however the intended use is for custom
finite types. See the examples for details.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ EFSM\isanewline
\ \ \isakeyword{imports}\ {\isachardoublequoteopen}{\isachartilde}{\isachartilde}{\isacharslash}src{\isacharslash}HOL{\isacharslash}Library{\isacharslash}FSet{\isachardoublequoteclose}\ Transition\ FSet{\isacharunderscore}Utils\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
\isanewline
\isanewline
\isacommand{declare}\isamarkupfalse%
\ One{\isacharunderscore}nat{\isacharunderscore}def\ {\isacharbrackleft}simp\ del{\isacharbrackright}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ cfstate\ {\isacharequal}\ nat\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ inputs\ {\isacharequal}\ {\isachardoublequoteopen}value\ list{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ outputs\ {\isacharequal}\ {\isachardoublequoteopen}value\ option\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ event\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}label\ {\isasymtimes}\ inputs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ trace\ {\isacharequal}\ {\isachardoublequoteopen}event\ list{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ observation\ {\isacharequal}\ {\isachardoublequoteopen}outputs\ list{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ transition{\isacharunderscore}matrix\ {\isacharequal}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharparenleft}cfstate\ {\isasymtimes}\ cfstate{\isacharparenright}\ {\isasymtimes}\ transition{\isacharparenright}\ fset{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ Str\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}string\ {\isasymRightarrow}\ value{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}Str\ s\ {\isasymequiv}\ value{\isachardot}Str\ {\isacharparenleft}String{\isachardot}implode\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ str{\isacharunderscore}not{\isacharunderscore}num{\isacharcolon}\ {\isachardoublequoteopen}Str\ s\ {\isasymnoteq}\ Num\ x{\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Str{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ S\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ fset{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}S\ m\ {\isacharequal}\ {\isacharparenleft}fimage\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ s{\isacharprime}{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ s{\isacharparenright}\ m{\isacharparenright}\ {\isacharbar}{\isasymunion}{\isacharbar}\ fimage\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ s{\isacharprime}{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ s{\isacharprime}{\isacharparenright}\ m{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}S\ e\ {\isacharequal}\ {\isacharparenleft}fst\ {\isasymcirc}\ fst{\isacharparenright}\ {\isacharbar}{\isacharbackquote}{\isacharbar}\ e\ {\isacharbar}{\isasymunion}{\isacharbar}\ {\isacharparenleft}snd\ {\isasymcirc}\ fst{\isacharparenright}\ {\isacharbar}{\isacharbackquote}{\isacharbar}\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ comp{\isacharunderscore}def\ S{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ apply{\isacharunderscore}outputs\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}aexp\ list\ {\isasymRightarrow}\ datastate\ {\isasymRightarrow}\ value\ option\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}outputs\ p\ s\ {\isacharequal}\ map\ {\isacharparenleft}{\isasymlambda}p{\isachardot}\ aval\ p\ s{\isacharparenright}\ p{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}nth{\isacharcolon}\ {\isachardoublequoteopen}i\ {\isacharless}\ length\ p\ {\isasymLongrightarrow}\ apply{\isacharunderscore}outputs\ p\ s\ {\isacharbang}\ i\ {\isacharequal}\ aval\ {\isacharparenleft}p\ {\isacharbang}\ i{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ apply{\isacharunderscore}outputs\ {\isacharequal}\ datastate\ apply{\isacharunderscore}outputs{\isacharunderscore}def\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}apply{\isacharunderscore}outputs\ {\isacharbrackleft}{\isacharbrackright}\ s\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}apply{\isacharunderscore}outputs\ p\ s{\isacharparenright}\ {\isacharequal}\ length\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}literal{\isacharcolon}\ {\isachardoublequoteopen}P\ {\isacharbang}\ r\ {\isacharequal}\ L\ v\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ r\ {\isacharless}\ length\ {\isacharparenleft}apply{\isacharunderscore}outputs\ P\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ c{\isacharparenright}{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ apply{\isacharunderscore}outputs\ P\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ c{\isacharparenright}\ {\isacharbang}\ r\ {\isacharequal}\ Some\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ P{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ P{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}Suc{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}disj\ nth{\isacharunderscore}map\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}register{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}c\ {\isachardollar}\ p\ {\isacharequal}\ Some\ v\ {\isasymLongrightarrow}\isanewline
\ \ \ r\ {\isacharless}\ length\ {\isacharparenleft}apply{\isacharunderscore}outputs\ P\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ c{\isacharparenright}{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}outputs\ {\isacharparenleft}list{\isacharunderscore}update\ P\ r\ {\isacharparenleft}V\ {\isacharparenleft}R\ p{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ c{\isacharparenright}\ {\isacharbang}\ r\ {\isacharequal}\ Some\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ P{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ P{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ r{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}outputs{\isacharunderscore}unupdated{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}ia\ {\isasymnoteq}\ r\ {\isasymLongrightarrow}\ \isanewline
\ \ \ ia\ {\isacharless}\ length\ {\isacharparenleft}apply{\isacharunderscore}outputs\ P\ j{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}outputs\ P\ j\ {\isacharbang}\ ia\ {\isacharequal}\ apply{\isacharunderscore}outputs\ {\isacharparenleft}list{\isacharunderscore}update\ P\ r\ v{\isacharparenright}j\ {\isacharbang}\ ia{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ P{\isacharparenright}\isanewline
\isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ P{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}preserves{\isacharunderscore}length{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ apply{\isacharunderscore}outputs{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ r{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ map{\isacharunderscore}update\ nth{\isacharunderscore}Cons{\isacharprime}{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ choice\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition\ {\isasymRightarrow}\ transition\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}choice\ t\ t{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}\ i\ r{\isachardot}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharprime}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ choice{\isacharunderscore}alt\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition\ {\isasymRightarrow}\ transition\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}choice{\isacharunderscore}alt\ t\ t{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}\ i\ r{\isachardot}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharat}Guard\ t{\isacharprime}{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ choice{\isacharunderscore}alt{\isacharcolon}\ {\isachardoublequoteopen}choice\ t\ t{\isacharprime}\ {\isacharequal}\ choice{\isacharunderscore}alt\ t\ t{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ choice{\isacharunderscore}def\ choice{\isacharunderscore}alt{\isacharunderscore}def\ apply{\isacharunderscore}guards{\isacharunderscore}append{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ choice{\isacharunderscore}symmetry{\isacharcolon}\ {\isachardoublequoteopen}choice\ x\ y\ {\isacharequal}\ choice\ y\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ choice{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ apply{\isacharunderscore}updates\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}updates\ {\isasymRightarrow}\ datastate\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ registers{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}updates\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharunderscore}\ new\ {\isacharequal}\ new{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}apply{\isacharunderscore}updates\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ old\ new\ {\isacharequal}\ {\isacharparenleft}apply{\isacharunderscore}updates\ t\ old\ new{\isacharparenright}{\isacharparenleft}fst\ h\ {\isachardollar}{\isacharcolon}{\isacharequal}\ aval\ {\isacharparenleft}snd\ h{\isacharparenright}\ old{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}updates{\isacharunderscore}foldr{\isacharcolon}\ {\isachardoublequoteopen}apply{\isacharunderscore}updates\ u\ old\ new\ {\isacharequal}\ foldr\ {\isacharparenleft}{\isasymlambda}h\ r{\isachardot}\ r{\isacharparenleft}fst\ h\ {\isachardollar}{\isacharcolon}{\isacharequal}\ aval\ {\isacharparenleft}snd\ h{\isacharparenright}\ old{\isacharparenright}{\isacharparenright}\ u\ new{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ u{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ u{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ eq{\isacharunderscore}finfun{\isacharunderscore}All{\isacharunderscore}ext\ finfun{\isacharunderscore}All{\isacharunderscore}def\ finfun{\isacharunderscore}All{\isacharunderscore}except{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ Cons{\isachardot}hyps{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ r{\isacharunderscore}not{\isacharunderscore}updated{\isacharunderscore}stays{\isacharunderscore}the{\isacharunderscore}same{\isacharcolon}\ {\isachardoublequoteopen}r\ {\isasymnotin}\ fst\ {\isacharbackquote}\ set\ U\ {\isasymLongrightarrow}\isanewline
\ \ \ \ apply{\isacharunderscore}updates\ U\ c\ d\ {\isachardollar}\ r\ {\isacharequal}\ d\ {\isachardollar}\ r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ U{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ U{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ possible{\isacharunderscore}steps\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ cfstate\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ label\ {\isasymRightarrow}\ inputs\ {\isasymRightarrow}\ {\isacharparenleft}cfstate\ {\isasymtimes}\ transition{\isacharparenright}\ fset{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ fimage\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ {\isacharparenleft}dest{\isacharcomma}\ t{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isacharcomma}\ t{\isacharcolon}{\isacharcolon}transition{\isacharparenright}{\isachardot}\ origin\ {\isacharequal}\ s\ {\isasymand}\ {\isacharparenleft}Label\ t{\isacharparenright}\ {\isacharequal}\ l\ {\isasymand}\ {\isacharparenleft}length\ i{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}Arity\ t{\isacharparenright}\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}\ e{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ in{\isacharunderscore}possible{\isacharunderscore}steps{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}a{\isacharcomma}\ bb{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ b\ s\ r\ ab\ ba\ {\isasymLongrightarrow}\ {\isasymexists}s{\isachardot}\ {\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ a{\isacharparenright}{\isacharcomma}\ bb{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ fimage{\isacharunderscore}def\ ffilter{\isacharunderscore}def\ fmember{\isacharunderscore}def\ Abs{\isacharunderscore}fset{\isacharunderscore}inverse{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}alt{\isacharunderscore}aux{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ {\isacharparenleft}dest{\isacharcomma}\ t{\isacharparenright}{\isacharparenright}\ {\isacharbar}{\isacharbackquote}{\isacharbar}\isanewline
\ \ \ \ ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ origin\ {\isacharequal}\ s\ {\isasymand}\ Label\ t\ {\isacharequal}\ l\ {\isasymand}\ length\ i\ {\isacharequal}\ Arity\ t\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}\ e\ {\isacharequal}\isanewline
\ \ \ \ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}d{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ ffilter\isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ origin\ {\isacharequal}\ s\ {\isasymand}\ Label\ t\ {\isacharequal}\ l\ {\isasymand}\ length\ i\ {\isacharequal}\ Arity\ t\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ case\ x\ of\ vname{\isachardot}I\ n\ {\isasymRightarrow}\ input{\isadigit{2}}state\ i\ {\isachardollar}\ n\ {\isacharbar}\ R\ n\ {\isasymRightarrow}\ r\ {\isachardollar}\ n{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ e\ {\isacharequal}\isanewline
\ \ \ \ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ d{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ e{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ empty\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}insert\ x\ e{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ffilter{\isacharunderscore}finsert\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}aa\ {\isacharequal}\ s{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}Label\ ba\ {\isacharequal}\ l{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}length\ i\ {\isacharequal}\ Arity\ ba{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ ba{\isacharparenright}\ {\isacharparenleft}case{\isacharunderscore}vname\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ input{\isadigit{2}}state\ i\ {\isachardollar}\ n{\isacharparenright}\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ r\ {\isachardollar}\ \ n{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}alt{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}d{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}ffilter\isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}{\isacharparenleft}origin{\isacharcomma}\ dest{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ origin\ {\isacharequal}\ s\ {\isasymand}\ Label\ t\ {\isacharequal}\ l\ {\isasymand}\ length\ i\ {\isacharequal}\ Arity\ t\ {\isasymand}\ apply{\isacharunderscore}guards\ {\isacharparenleft}Guard\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ e\ {\isacharequal}\isanewline
\ \ \ \ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ d{\isacharparenright}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ standard\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ possible{\isacharunderscore}steps{\isacharunderscore}alt{\isacharunderscore}aux\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ join{\isacharunderscore}ir{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}singleton\ {\isacharequal}\ possible{\isacharunderscore}steps{\isacharunderscore}alt\ Abs{\isacharunderscore}ffilter\ Set{\isachardot}filter{\isacharunderscore}def\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}empty\ {\isacharequal}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ Abs{\isacharunderscore}ffilter\ Set{\isachardot}filter{\isacharunderscore}def\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ singleton{\isacharunderscore}dest{\isacharcolon}\ {\isachardoublequoteopen}fis{\isacharunderscore}singleton\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ b{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ fthe{\isacharunderscore}elem\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ b{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}baa{\isacharcomma}\ aba{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\isacharparenleft}s{\isacharcomma}\ baa{\isacharparenright}{\isacharcomma}\ aba{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ e{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ fis{\isacharunderscore}singleton{\isacharunderscore}def\ fthe{\isacharunderscore}elem{\isacharunderscore}def\ singleton{\isacharunderscore}equiv{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ possible{\isacharunderscore}steps{\isacharunderscore}def\ fmember{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ random{\isacharunderscore}member\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ fset\ {\isasymRightarrow}\ {\isacharprime}a\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}random{\isacharunderscore}member\ f\ {\isacharequal}\ {\isacharparenleft}if\ f\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ then\ None\ else\ Some\ {\isacharparenleft}Eps\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isacharbar}{\isasymin}{\isacharbar}\ f{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{inductive}\isamarkupfalse%
\ accepts\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ base{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \isanewline
\ \ step{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ l\ i{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ d{\isacharparenright}\ d{\isacharparenright}\ t\ {\isasymLongrightarrow}\isanewline
\ \ \ \ \ \ \ \ \ accepts\ e\ s\ d\ {\isacharparenleft}{\isacharparenleft}l{\isacharcomma}\ i{\isacharparenright}{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}rejects\ e\ s\ d\ t\ {\isasymequiv}\ {\isasymnot}\ accepts\ e\ s\ d\ t{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}step{\isacharunderscore}equiv{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}{\isacharparenleft}l{\isacharcomma}\ i{\isacharparenright}{\isacharhash}t{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ l\ i{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ d{\isacharparenright}\ d{\isacharparenright}\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ standard\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ accepts{\isachardot}simps\ list{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ list{\isachardot}simps{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ prod{\isachardot}sel{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ prod{\isachardot}sel{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isachardot}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}must{\isacharunderscore}be{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ r\ {\isacharparenleft}h\ {\isacharhash}\ t{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymexists}aa\ ba{\isachardot}\ {\isacharparenleft}aa{\isacharcomma}\ ba{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ accepts{\isacharunderscore}step{\isacharunderscore}equiv\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{type{\isacharunderscore}synonym}\isamarkupfalse%
\ stepping{\isacharunderscore}function\ {\isacharequal}\ {\isachardoublequoteopen}trace\ {\isasymRightarrow}\ transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ cfstate\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ label\ {\isasymRightarrow}\ inputs\ {\isasymRightarrow}\ {\isacharparenleft}transition\ {\isasymtimes}\ cfstate\ {\isasymtimes}\ outputs\ {\isasymtimes}\ registers{\isacharparenright}\ option{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ step\ {\isacharcolon}{\isacharcolon}\ stepping{\isacharunderscore}function\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}step\ tr\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharparenleft}let\ \isanewline
\ \ \ \ poss{\isacharunderscore}steps\ {\isacharequal}\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i{\isacharparenright}{\isacharsemicolon}\isanewline
\ \ \ \ possibilities\ {\isacharequal}\ ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r{\isacharparenright}\ tr{\isacharparenright}\ poss{\isacharunderscore}steps\ in\isanewline
\ \ \ \ case\ random{\isacharunderscore}member\ possibilities\ of\isanewline
\ \ \ \ \ \ None\ {\isasymRightarrow}\ None\ {\isacharbar}\isanewline
\ \ \ \ \ \ Some\ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}\ {\isasymRightarrow}\ \ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharcomma}\ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r{\isacharparenright}\isanewline
\ \ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ step{\isacharunderscore}lax\ {\isacharcolon}{\isacharcolon}\ stepping{\isacharunderscore}function\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}step{\isacharunderscore}lax\ tr\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharparenleft}case\ random{\isacharunderscore}member\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i{\isacharparenright}\ of\isanewline
\ \ \ \ \ \ None\ {\isasymRightarrow}\ None\ {\isacharbar}\isanewline
\ \ \ \ \ \ Some\ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}\ {\isasymRightarrow}\ \ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}{\isacharcomma}\ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r{\isacharparenright}\isanewline
\ \ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}some{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}poss{\isacharunderscore}steps\ {\isacharequal}\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ possibilities\ {\isacharequal}\ ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r{\isacharparenright}\ tr{\isacharparenright}\ poss{\isacharunderscore}steps\ {\isasymLongrightarrow}\isanewline
\ \ \ random{\isacharunderscore}member\ possibilities\ {\isacharequal}\ Some\ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ {\isacharequal}\ p\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r\ {\isacharequal}\ r{\isacharprime}\ {\isasymLongrightarrow}\isanewline
\ \ \ step\ tr\ e\ s\ r\ l\ i\ {\isacharequal}\ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharcomma}\ r{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ no{\isacharunderscore}possible{\isacharunderscore}steps{\isacharunderscore}{\isadigit{1}}{\isacharcolon}\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ l\ i\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\ step\ t\ e\ s\ r\ l\ i\ {\isacharequal}\ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ observe{\isacharunderscore}all\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ stepping{\isacharunderscore}function\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ {\isacharparenleft}transition\ {\isasymtimes}\ nat\ {\isasymtimes}\ outputs\ {\isasymtimes}\ registers{\isacharparenright}\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}observe{\isacharunderscore}all\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}observe{\isacharunderscore}all\ e\ s\ r\ st\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ \ {\isacharequal}\isanewline
\ \ \ \ {\isacharparenleft}case\ {\isacharparenleft}st\ t\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isacharparenright}\ of\isanewline
\ \ \ \ \ \ {\isacharparenleft}Some\ {\isacharparenleft}transition{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ outputs{\isacharcomma}\ updated{\isacharparenright}{\isacharparenright}\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharparenleft}{\isacharparenleft}transition{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ outputs{\isacharcomma}\ updated{\isacharparenright}{\isacharhash}{\isacharparenleft}observe{\isacharunderscore}all\ e\ s{\isacharprime}\ updated\ st\ t{\isacharparenright}{\isacharparenright}{\isacharparenright}\ {\isacharbar}\isanewline
\ \ \ \ \ \ {\isacharunderscore}\ {\isasymRightarrow}\ {\isacharbrackleft}{\isacharbrackright}\isanewline
\ \ \ \ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ state\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}transition\ {\isasymtimes}\ nat\ {\isasymtimes}\ outputs\ {\isasymtimes}\ datastate{\isacharparenright}\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}state\ x\ {\isasymequiv}\ fst\ {\isacharparenleft}snd\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ observe{\isacharunderscore}trace\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ stepping{\isacharunderscore}function\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ observation{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}observe{\isacharunderscore}trace\ e\ s\ r\ st\ t\ {\isasymequiv}\ map\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}t{\isacharcomma}x{\isacharcomma}y{\isacharcomma}z{\isacharparenright}{\isachardot}\ y{\isacharparenright}\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ st\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rejects{\isacharunderscore}observe{\isacharunderscore}empty{\isacharunderscore}quantified{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}s\ d{\isachardot}\ rejects\ e\ s\ d\ t\ {\isasymlongrightarrow}\ observe{\isacharunderscore}trace\ e\ s\ d\ step\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ t{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isachardot}base{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ as{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ d\ aa\ b\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ no{\isacharunderscore}possible{\isacharunderscore}steps{\isacharunderscore}{\isadigit{1}}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def\ step{\isacharunderscore}def\ random{\isacharunderscore}member{\isacharunderscore}def\ Let{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ accepts{\isachardot}step\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rejects{\isacharunderscore}observe{\isacharunderscore}empty{\isacharcolon}\ {\isachardoublequoteopen}rejects\ e\ s\ d\ t\ {\isasymLongrightarrow}\ observe{\isacharunderscore}trace\ e\ s\ d\ step\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ rejects{\isacharunderscore}observe{\isacharunderscore}empty{\isacharunderscore}quantified{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}empty\ {\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}observe{\isacharunderscore}trace\ e\ s\ r\ st\ {\isacharbrackleft}{\isacharbrackright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}step{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}step\ es\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharcomma}\ r{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e\ s{\isacharprime}\ r{\isacharprime}\ step\ es\ {\isacharequal}\ obs\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e\ s\ r\ step\ {\isacharparenleft}h{\isacharhash}es{\isacharparenright}\ {\isacharequal}\ p{\isacharhash}obs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isacharparenright}\ r{\isacharparenright}\ es\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isacharparenright}\ {\isacharequal}\ p\ {\isasymLongrightarrow}\isanewline
\ \ \ apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ r{\isacharparenright}\ r\ {\isacharequal}\ r{\isacharprime}\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e\ s{\isacharprime}\ r{\isacharprime}\ step\ es\ {\isacharequal}\ obs\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e\ s\ r\ step\ {\isacharparenleft}h{\isacharhash}es{\isacharparenright}\ {\isacharequal}\ p{\isacharhash}obs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}step{\isacharbrackleft}of\ es\ e\ s\ r\ h\ t\ s{\isacharprime}\ p\ r{\isacharprime}\ obs{\isacharbrackright}\isanewline
\ \ \ \ \ \ \ \ step{\isacharunderscore}some{\isacharbrackleft}of\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}\ e\ s\ r\ {\isachardoublequoteopen}fst\ h{\isachardoublequoteclose}\ {\isachardoublequoteopen}snd\ h{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharbraceleft}{\isacharbar}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}\ es\ s{\isacharprime}\ t\ p\ r{\isacharprime}{\isacharbrackright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ ffilter{\isacharunderscore}singleton\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e\ s\ r\ step\ {\isacharparenleft}h{\isacharhash}es{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def\ step{\isacharunderscore}def\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ observably{\isacharunderscore}equivalent\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}observably{\isacharunderscore}equivalent\ e{\isadigit{1}}\ e{\isadigit{2}}\ t\ {\isasymequiv}\ {\isacharparenleft}{\isacharparenleft}observe{\isacharunderscore}trace\ e{\isadigit{1}}\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ step\ t{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}observe{\isacharunderscore}trace\ e{\isadigit{2}}\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ step\ t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observably{\isacharunderscore}equivalent{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}step{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e{\isadigit{1}}\ s{\isadigit{1}}\ r{\isadigit{1}}\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ possible{\isacharunderscore}steps\ e{\isadigit{2}}\ s{\isadigit{2}}\ r{\isadigit{2}}\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\isanewline
\ \ \ observe{\isacharunderscore}trace\ e{\isadigit{1}}\ s{\isadigit{1}}\ r{\isadigit{1}}\ step\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isacharequal}\ observe{\isacharunderscore}trace\ e{\isadigit{2}}\ s{\isadigit{2}}\ r{\isadigit{2}}\ step\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observably{\isacharunderscore}equivalent{\isacharunderscore}reflexive{\isacharcolon}\ {\isachardoublequoteopen}observably{\isacharunderscore}equivalent\ e{\isadigit{1}}\ e{\isadigit{1}}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observably{\isacharunderscore}equivalent{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observably{\isacharunderscore}equivalent{\isacharunderscore}symmetric{\isacharcolon}\ {\isachardoublequoteopen}observably{\isacharunderscore}equivalent\ e{\isadigit{1}}\ e{\isadigit{2}}\ t\ {\isacharequal}\ observably{\isacharunderscore}equivalent\ e{\isadigit{2}}\ e{\isadigit{1}}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ observably{\isacharunderscore}equivalent{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observably{\isacharunderscore}equivalent{\isacharunderscore}transitive{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}observably{\isacharunderscore}equivalent\ e{\isadigit{1}}\ e{\isadigit{2}}\ t\ {\isasymLongrightarrow}\isanewline
\ \ \ observably{\isacharunderscore}equivalent\ e{\isadigit{2}}\ e{\isadigit{3}}\ t\ {\isasymLongrightarrow}\isanewline
\ \ \ observably{\isacharunderscore}equivalent\ e{\isadigit{1}}\ e{\isadigit{3}}\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observably{\isacharunderscore}equivalent{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}preserves{\isacharunderscore}length{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ st\ t{\isacharparenright}\ {\isacharequal}\ length\ {\isacharparenleft}observe{\isacharunderscore}trace\ e\ s\ r\ st\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ length{\isacharunderscore}observation{\isacharunderscore}leq{\isacharunderscore}length{\isacharunderscore}trace{\isacharcolon}\ {\isachardoublequoteopen}{\isasymAnd}s\ r{\isachardot}\ length\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ st\ t{\isacharparenright}\ {\isasymle}\ length\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induction\ t{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ t{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}st\ t\ e\ s\ r\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}possible{\isacharunderscore}steps{\isacharunderscore}not{\isacharunderscore}empty{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isasymLongrightarrow}\ possible{\isacharunderscore}steps\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isasymnoteq}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}must{\isacharunderscore}be{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}ts{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymexists}t\ s{\isacharprime}\ p\ d{\isacharprime}{\isachardot}\ step\ ts\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ Some\ {\isacharparenleft}t{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ p{\isacharcomma}\ d{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ h{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isacharunderscore}step{\isacharunderscore}equiv\ step{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}{\isacharparenleft}ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ b\ d{\isacharparenright}\ d{\isacharparenright}\ ts{\isacharparenright}\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ d\ a\ b{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\isadigit{1}}{\isacharbrackright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ case{\isacharunderscore}prod{\isacharunderscore}conv\ old{\isachardot}prod{\isachardot}exhaust{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}cons{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymexists}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ h{\isacharparenright}\ d{\isacharparenright}\ d{\isacharparenright}\ t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ h{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ standard\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}metis\ accepts{\isachardot}simps\ fst{\isacharunderscore}conv\ list{\isachardot}distinct{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ list{\isachardot}inject\ snd{\isacharunderscore}conv{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isachardot}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}cons{\isacharunderscore}step{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ r\ {\isacharparenleft}h\ {\isacharhash}\ t{\isacharparenright}\ {\isasymLongrightarrow}\ step\ t\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isasymnoteq}\ \ None{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ accepts{\isacharunderscore}must{\isacharunderscore}be{\isacharunderscore}step{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ accepts{\isacharunderscore}trace\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}accepts{\isacharunderscore}trace\ e\ t\ {\isasymequiv}\ accepts\ e\ {\isadigit{0}}\ {\isacharless}{\isachargreater}\ t{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ no{\isacharunderscore}step{\isacharunderscore}none{\isacharcolon}\ {\isachardoublequoteopen}step\ p\ e\ s\ r\ aa\ ba\ {\isacharequal}\ None\ {\isasymLongrightarrow}\ rejects\ e\ s\ r\ {\isacharparenleft}{\isacharparenleft}aa{\isacharcomma}\ ba{\isacharparenright}\ {\isacharhash}\ p{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ accepts{\isachardot}cases{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}{\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ ba{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}{\isacharparenleft}ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ ba\ r{\isacharparenright}\ r{\isacharparenright}\ p{\isacharparenright}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ ba{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ auto{\isacharbrackleft}{\isadigit{1}}{\isacharbrackright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}SOME\ x{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ r\ aa\ ba\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}case\ x\ of\ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}\ {\isasymRightarrow}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ ba\ r{\isacharparenright}\ r{\isacharparenright}\ p{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ step{\isacharunderscore}none{\isacharunderscore}rejects{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharparenleft}step\ t\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ None{\isacharparenright}\ {\isasymLongrightarrow}\ {\isasymnot}\ {\isacharparenleft}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ no{\isacharunderscore}step{\isacharunderscore}none\ surjective{\isacharunderscore}pairing\ \isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ possible{\isacharunderscore}steps{\isacharunderscore}not{\isacharunderscore}empty{\isacharunderscore}iff{\isacharcolon}\ \isanewline
\ \ {\isachardoublequoteopen}step\ t\ e\ s\ d\ a\ b\ {\isasymnoteq}\ None\ {\isasymLongrightarrow}\isanewline
\ \ \ {\isasymexists}aa\ ba{\isachardot}\ {\isacharparenleft}aa{\isacharcomma}\ ba{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ a\ b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ d\ a\ b{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ trace{\isacharunderscore}reject{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}steps{\isacharcolon}\ {\isachardoublequoteopen}possible{\isacharunderscore}steps\ e\ s\ d\ a\ b\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymLongrightarrow}\ rejects\ e\ s\ d\ {\isacharparenleft}{\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ accepts{\isacharunderscore}possible{\isacharunderscore}steps{\isacharunderscore}not{\isacharunderscore}empty\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ trace{\isacharunderscore}reject{\isacharunderscore}later{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ a\ b{\isachardot}\ rejects\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ b\ d{\isacharparenright}\ d{\isacharparenright}\ t\ {\isasymLongrightarrow}\ rejects\ e\ s\ d\ {\isacharparenleft}{\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ accepts{\isacharunderscore}cons\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ trace{\isacharunderscore}reject{\isacharunderscore}{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}rejects\ e\ s\ d\ {\isacharparenleft}{\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}{\isacharhash}t{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ d\ a\ b\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ {\isasymor}\ {\isacharparenleft}{\isasymforall}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ a\ b{\isachardot}\ rejects\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ b\ d{\isacharparenright}\ d{\isacharparenright}\ t{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ accepts{\isacharunderscore}cons\ case{\isacharunderscore}prod{\isacharunderscore}unfold\ fBallI\ fBexI\ fst{\isacharunderscore}conv\ snd{\isacharunderscore}conv\ trace{\isacharunderscore}reject{\isacharunderscore}later\ trace{\isacharunderscore}reject{\isacharunderscore}no{\isacharunderscore}possible{\isacharunderscore}steps{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rejects{\isacharunderscore}prefix{\isacharunderscore}all{\isacharunderscore}s{\isacharunderscore}d{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}s\ d{\isachardot}\ rejects\ e\ s\ d\ t\ {\isasymlongrightarrow}\ rejects\ e\ s\ d\ {\isacharparenleft}t\ {\isacharat}\ t{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ t{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ base{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ t{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}mono{\isacharunderscore}tags{\isacharcomma}\ lifting{\isacharparenright}\ accepts{\isacharunderscore}cons\ append{\isacharunderscore}Cons\ case{\isacharunderscore}prod{\isacharunderscore}unfold\ fBexE\ fBexI{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rejects{\isacharunderscore}prefix{\isacharcolon}\ {\isachardoublequoteopen}rejects\ e\ s\ d\ t\ {\isasymLongrightarrow}\ rejects\ e\ s\ d\ {\isacharparenleft}t\ {\isacharat}\ t{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ rejects{\isacharunderscore}prefix{\isacharunderscore}all{\isacharunderscore}s{\isacharunderscore}d{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ prefix{\isacharunderscore}closure{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}t{\isacharat}t{\isacharprime}{\isacharparenright}\ {\isasymLongrightarrow}\ accepts\ e\ s\ d\ t{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ rejects{\isacharunderscore}prefix{\isacharunderscore}all{\isacharunderscore}s{\isacharunderscore}d\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ accepts{\isacharunderscore}head{\isacharcolon}\ {\isachardoublequoteopen}accepts\ e\ s\ d\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}\ {\isasymLongrightarrow}\ accepts\ e\ s\ d\ {\isacharbrackleft}h{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ accepts{\isacharunderscore}cons\ accepts{\isachardot}base\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{inductive}\isamarkupfalse%
\ gets{\isacharunderscore}us{\isacharunderscore}to\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ base{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isacharequal}\ target\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ {\isacharunderscore}\ s\ {\isacharunderscore}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ step{\isacharunderscore}some{\isacharcolon}\ {\isachardoublequoteopen}{\isasymexists}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ d\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}{\isachardot}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ i\ r{\isacharparenright}\ r{\isacharparenright}\ t\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ step{\isacharunderscore}none{\isacharcolon}\ {\isachardoublequoteopen}step\ t\ e\ s\ r\ {\isacharparenleft}fst\ h{\isacharparenright}\ {\isacharparenleft}snd\ h{\isacharparenright}\ {\isacharequal}\ None\ {\isasymLongrightarrow}\ s\ {\isacharequal}\ target\ {\isasymLongrightarrow}\ gets{\isacharunderscore}us{\isacharunderscore}to\ target\ e\ s\ r\ {\isacharparenleft}h{\isacharhash}t{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ no{\isacharunderscore}further{\isacharunderscore}steps{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymnoteq}\ s{\isacharprime}\ {\isasymLongrightarrow}\ {\isasymnot}\ gets{\isacharunderscore}us{\isacharunderscore}to\ s\ e\ s{\isacharprime}\ r\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule\ gets{\isacharunderscore}us{\isacharunderscore}to{\isachardot}cases{\isacharparenright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ accepting{\isacharunderscore}sequence\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}transition{\isacharunderscore}matrix\ {\isasymRightarrow}\ cfstate\ {\isasymRightarrow}\ registers\ {\isasymRightarrow}\ trace\ {\isasymRightarrow}\ {\isacharparenleft}transition\ {\isasymtimes}\ cfstate\ {\isasymtimes}\ outputs\ {\isasymtimes}\ registers{\isacharparenright}\ list\ {\isasymRightarrow}\ {\isacharparenleft}transition\ {\isasymtimes}\ cfstate\ {\isasymtimes}\ outputs\ {\isasymtimes}\ registers{\isacharparenright}\ list\ option{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}accepting{\isacharunderscore}sequence\ {\isacharunderscore}\ {\isacharunderscore}\ r\ {\isacharbrackleft}{\isacharbrackright}\ obs\ {\isacharequal}\ Some\ {\isacharparenleft}rev\ obs{\isacharparenright}{\isachardoublequoteclose}\ {\isacharbar}\isanewline
\ \ {\isachardoublequoteopen}accepting{\isacharunderscore}sequence\ e\ s\ r\ {\isacharparenleft}a{\isacharhash}t{\isacharparenright}\ obs\ {\isacharequal}\ {\isacharparenleft}let\isanewline
\ \ \ \ poss\ {\isacharequal}\ possible{\isacharunderscore}steps\ e\ s\ r\ {\isacharparenleft}fst\ a{\isacharparenright}\ {\isacharparenleft}snd\ a{\isacharparenright}{\isacharsemicolon}\isanewline
\ \ \ \ accepting\ {\isacharequal}\ ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ a{\isacharparenright}\ r{\isacharparenright}\ r{\isacharparenright}\ t{\isacharparenright}\ poss\ \ in\isanewline
\ \ \ \ if\ accepting\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}\ then\isanewline
\ \ \ \ \ \ None\isanewline
\ \ \ \ else\ let\isanewline
\ \ \ \ \ \ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ T{\isacharparenright}\ {\isacharequal}\ Eps\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ x\ {\isacharbar}{\isasymin}{\isacharbar}\ accepting{\isacharparenright}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ r{\isacharprime}\ {\isacharequal}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ a{\isacharparenright}\ r{\isacharparenright}\ r{\isacharparenright}\ in\isanewline
\ \ \ \ \ \ accepting{\isacharunderscore}sequence\ e\ s{\isacharprime}\ r{\isacharprime}\ t\ {\isacharparenleft}{\isacharparenleft}T{\isacharcomma}\ s{\isacharprime}{\isacharcomma}\ {\isacharparenleft}apply{\isacharunderscore}outputs\ {\isacharparenleft}Outputs\ T{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ {\isacharparenleft}snd\ a{\isacharparenright}\ r{\isacharparenright}{\isacharparenright}{\isacharcomma}\ r{\isacharprime}{\isacharparenright}{\isacharhash}obs{\isacharparenright}\isanewline
\ \ {\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rejects{\isacharunderscore}no{\isacharunderscore}obs{\isacharunderscore}quantified{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}s\ r{\isachardot}\ rejects\ e\ s\ r\ t\ {\isasymlongrightarrow}\ observe{\isacharunderscore}all\ e\ s\ r\ step\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}induct\ t{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ accepts{\isachardot}base\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Cons\ a\ as{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}cases\ a{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}step\ as\ e\ s\ r\ aa\ b{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ aaa{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ step{\isacharunderscore}def\ trace{\isacharunderscore}reject{\isacharunderscore}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}{\isacharparenleft}ffilter\ {\isacharparenleft}{\isasymlambda}{\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}{\isachardot}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ b\ r{\isacharparenright}\ r{\isacharparenright}\ as{\isacharparenright}\ {\isacharparenleft}possible{\isacharunderscore}steps\ e\ s\ r\ aa\ b{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbar}{\isacharbar}{\isacharbraceright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ random{\isacharunderscore}member{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}case{\isacharunderscore}tac\ {\isachardoublequoteopen}SOME\ x{\isachardot}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ {\isacharbar}{\isasymin}{\isacharbar}\ possible{\isacharunderscore}steps\ e\ s\ r\ aa\ b\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}case\ x\ of\ {\isacharparenleft}s{\isacharprime}{\isacharcomma}\ t{\isacharparenright}\ {\isasymRightarrow}\ accepts\ e\ s{\isacharprime}\ {\isacharparenleft}apply{\isacharunderscore}updates\ {\isacharparenleft}Updates\ t{\isacharparenright}\ {\isacharparenleft}join{\isacharunderscore}ir\ b\ r{\isacharparenright}\ r{\isacharparenright}\ as{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ clarify\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ rejects{\isacharunderscore}no{\isacharunderscore}obs{\isacharcolon}\ {\isachardoublequoteopen}rejects\ e\ s\ r\ t\ {\isasymLongrightarrow}\ observe{\isacharunderscore}all\ e\ s\ r\ step\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ rejects{\isacharunderscore}no{\isacharunderscore}obs{\isacharunderscore}quantified\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ observe{\isacharunderscore}trace{\isacharunderscore}empty{\isacharunderscore}iff{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}observe{\isacharunderscore}trace\ e\ s\ r\ st\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}observe{\isacharunderscore}all\ e\ s\ r\ st\ t\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observe{\isacharunderscore}trace{\isacharunderscore}def{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/efsm-sal/theories/EFSM.thy%:%
%:%11=1%:%
%:%23=3%:%
%:%24=4%:%
%:%25=5%:%
%:%26=6%:%
%:%34=9%:%
%:%35=9%:%
%:%36=10%:%
%:%37=11%:%
%:%44=11%:%
%:%45=12%:%
%:%46=13%:%
%:%47=13%:%
%:%48=14%:%
%:%49=15%:%
%:%50=15%:%
%:%51=16%:%
%:%52=16%:%
%:%53=17%:%
%:%54=17%:%
%:%55=18%:%
%:%56=19%:%
%:%57=19%:%
%:%58=20%:%
%:%59=20%:%
%:%60=21%:%
%:%61=21%:%
%:%62=22%:%
%:%63=22%:%
%:%64=23%:%
%:%65=24%:%
%:%66=24%:%
%:%67=25%:%
%:%68=26%:%
%:%69=27%:%
%:%70=27%:%
%:%73=28%:%
%:%77=28%:%
%:%78=28%:%
%:%83=28%:%
%:%86=29%:%
%:%87=30%:%
%:%88=30%:%
%:%89=31%:%
%:%90=32%:%
%:%91=33%:%
%:%92=33%:%
%:%95=34%:%
%:%99=34%:%
%:%100=34%:%
%:%101=35%:%
%:%102=35%:%
%:%107=35%:%
%:%110=36%:%
%:%111=37%:%
%:%112=37%:%
%:%113=38%:%
%:%114=39%:%
%:%115=40%:%
%:%116=40%:%
%:%119=41%:%
%:%123=41%:%
%:%124=41%:%
%:%129=41%:%
%:%132=42%:%
%:%133=43%:%
%:%134=43%:%
%:%135=44%:%
%:%136=45%:%
%:%137=45%:%
%:%140=46%:%
%:%144=46%:%
%:%145=46%:%
%:%150=46%:%
%:%153=47%:%
%:%154=48%:%
%:%155=48%:%
%:%158=49%:%
%:%162=49%:%
%:%163=49%:%
%:%168=49%:%
%:%171=50%:%
%:%172=51%:%
%:%173=51%:%
%:%175=53%:%
%:%182=54%:%
%:%183=54%:%
%:%184=55%:%
%:%185=55%:%
%:%186=56%:%
%:%187=56%:%
%:%188=56%:%
%:%189=57%:%
%:%190=57%:%
%:%191=58%:%
%:%192=58%:%
%:%193=59%:%
%:%194=59%:%
%:%195=60%:%
%:%196=60%:%
%:%197=60%:%
%:%198=61%:%
%:%199=61%:%
%:%200=62%:%
%:%201=62%:%
%:%202=63%:%
%:%203=63%:%
%:%204=63%:%
%:%205=64%:%
%:%211=64%:%
%:%214=65%:%
%:%215=66%:%
%:%216=66%:%
%:%217=67%:%
%:%219=69%:%
%:%226=70%:%
%:%227=70%:%
%:%228=71%:%
%:%229=71%:%
%:%230=72%:%
%:%231=72%:%
%:%232=72%:%
%:%233=73%:%
%:%234=73%:%
%:%235=74%:%
%:%236=74%:%
%:%237=75%:%
%:%238=75%:%
%:%239=76%:%
%:%240=76%:%
%:%241=76%:%
%:%242=77%:%
%:%243=77%:%
%:%244=78%:%
%:%245=78%:%
%:%246=79%:%
%:%247=79%:%
%:%248=80%:%
%:%249=80%:%
%:%250=81%:%
%:%251=81%:%
%:%252=82%:%
%:%258=82%:%
%:%261=83%:%
%:%262=84%:%
%:%263=84%:%
%:%264=85%:%
%:%266=87%:%
%:%273=88%:%
%:%274=88%:%
%:%275=89%:%
%:%276=89%:%
%:%277=90%:%
%:%278=90%:%
%:%279=90%:%
%:%280=91%:%
%:%281=91%:%
%:%282=92%:%
%:%283=92%:%
%:%284=93%:%
%:%285=93%:%
%:%286=94%:%
%:%287=94%:%
%:%288=94%:%
%:%289=95%:%
%:%290=95%:%
%:%291=96%:%
%:%292=96%:%
%:%293=97%:%
%:%294=97%:%
%:%295=98%:%
%:%296=98%:%
%:%297=99%:%
%:%298=99%:%
%:%299=100%:%
%:%305=100%:%
%:%308=101%:%
%:%309=102%:%
%:%310=102%:%
%:%311=103%:%
%:%312=104%:%
%:%313=105%:%
%:%314=105%:%
%:%315=106%:%
%:%316=107%:%
%:%317=108%:%
%:%318=108%:%
%:%321=109%:%
%:%325=109%:%
%:%326=109%:%
%:%331=109%:%
%:%334=110%:%
%:%335=111%:%
%:%336=111%:%
%:%339=112%:%
%:%343=112%:%
%:%344=112%:%
%:%345=112%:%
%:%350=112%:%
%:%353=113%:%
%:%354=114%:%
%:%355=114%:%
%:%356=115%:%
%:%357=116%:%
%:%358=117%:%
%:%359=118%:%
%:%360=118%:%
%:%367=119%:%
%:%368=119%:%
%:%369=120%:%
%:%370=120%:%
%:%371=121%:%
%:%372=121%:%
%:%373=121%:%
%:%374=122%:%
%:%375=122%:%
%:%376=123%:%
%:%377=123%:%
%:%378=124%:%
%:%379=124%:%
%:%380=125%:%
%:%381=125%:%
%:%382=125%:%
%:%383=126%:%
%:%384=126%:%
%:%385=127%:%
%:%386=127%:%
%:%387=128%:%
%:%393=128%:%
%:%396=129%:%
%:%397=130%:%
%:%398=130%:%
%:%399=131%:%
%:%406=132%:%
%:%407=132%:%
%:%408=133%:%
%:%409=133%:%
%:%410=134%:%
%:%411=134%:%
%:%412=134%:%
%:%413=135%:%
%:%414=135%:%
%:%415=136%:%
%:%416=136%:%
%:%417=137%:%
%:%418=137%:%
%:%419=138%:%
%:%420=138%:%
%:%421=138%:%
%:%422=139%:%
%:%423=139%:%
%:%424=140%:%
%:%430=140%:%
%:%433=141%:%
%:%434=142%:%
%:%435=142%:%
%:%436=143%:%
%:%437=144%:%
%:%438=145%:%
%:%439=145%:%
%:%442=146%:%
%:%446=146%:%
%:%447=146%:%
%:%448=147%:%
%:%449=147%:%
%:%454=147%:%
%:%457=148%:%
%:%458=149%:%
%:%459=149%:%
%:%466=156%:%
%:%473=157%:%
%:%474=157%:%
%:%475=158%:%
%:%476=158%:%
%:%477=159%:%
%:%478=159%:%
%:%479=159%:%
%:%480=160%:%
%:%481=160%:%
%:%482=161%:%
%:%483=161%:%
%:%484=162%:%
%:%485=162%:%
%:%486=163%:%
%:%487=163%:%
%:%488=163%:%
%:%489=164%:%
%:%490=164%:%
%:%491=165%:%
%:%492=165%:%
%:%493=166%:%
%:%494=166%:%
%:%495=167%:%
%:%496=167%:%
%:%497=168%:%
%:%498=168%:%
%:%499=169%:%
%:%500=169%:%
%:%501=170%:%
%:%502=170%:%
%:%503=171%:%
%:%504=171%:%
%:%505=172%:%
%:%506=172%:%
%:%507=173%:%
%:%508=173%:%
%:%509=174%:%
%:%510=174%:%
%:%511=175%:%
%:%512=175%:%
%:%513=176%:%
%:%514=176%:%
%:%515=177%:%
%:%521=177%:%
%:%524=178%:%
%:%525=179%:%
%:%526=179%:%
%:%530=183%:%
%:%533=184%:%
%:%537=184%:%
%:%538=184%:%
%:%539=185%:%
%:%540=185%:%
%:%541=186%:%
%:%542=186%:%
%:%547=186%:%
%:%550=187%:%
%:%551=188%:%
%:%552=188%:%
%:%553=189%:%
%:%554=189%:%
%:%555=190%:%
%:%556=191%:%
%:%557=191%:%
%:%559=193%:%
%:%562=194%:%
%:%566=194%:%
%:%567=194%:%
%:%568=195%:%
%:%569=195%:%
%:%570=196%:%
%:%571=196%:%
%:%576=196%:%
%:%579=197%:%
%:%580=198%:%
%:%581=198%:%
%:%582=199%:%
%:%583=200%:%
%:%584=201%:%
%:%585=201%:%
%:%586=202%:%
%:%587=203%:%
%:%589=205%:%
%:%590=206%:%
%:%591=207%:%
%:%592=207%:%
%:%593=208%:%
%:%594=209%:%
%:%595=209%:%
%:%596=210%:%
%:%599=211%:%
%:%603=211%:%
%:%604=211%:%
%:%605=212%:%
%:%606=212%:%
%:%607=213%:%
%:%608=213%:%
%:%613=213%:%
%:%616=214%:%
%:%617=215%:%
%:%618=215%:%
%:%621=216%:%
%:%625=216%:%
%:%626=216%:%
%:%627=216%:%
%:%632=216%:%
%:%635=217%:%
%:%636=218%:%
%:%637=218%:%
%:%638=219%:%
%:%639=220%:%
%:%640=220%:%
%:%641=221%:%
%:%647=227%:%
%:%648=228%:%
%:%649=229%:%
%:%650=229%:%
%:%651=230%:%
%:%654=233%:%
%:%655=234%:%
%:%656=235%:%
%:%657=235%:%
%:%658=236%:%
%:%663=241%:%
%:%666=242%:%
%:%670=242%:%
%:%671=242%:%
%:%676=242%:%
%:%679=243%:%
%:%680=244%:%
%:%681=244%:%
%:%684=245%:%
%:%688=245%:%
%:%689=245%:%
%:%694=245%:%
%:%697=246%:%
%:%698=247%:%
%:%699=247%:%
%:%700=248%:%
%:%701=249%:%
%:%705=253%:%
%:%706=254%:%
%:%707=255%:%
%:%708=255%:%
%:%709=256%:%
%:%710=257%:%
%:%711=258%:%
%:%712=258%:%
%:%713=259%:%
%:%714=260%:%
%:%715=261%:%
%:%716=261%:%
%:%723=262%:%
%:%724=262%:%
%:%725=263%:%
%:%726=263%:%
%:%727=264%:%
%:%728=264%:%
%:%729=264%:%
%:%730=265%:%
%:%731=265%:%
%:%732=266%:%
%:%733=266%:%
%:%734=267%:%
%:%735=267%:%
%:%736=268%:%
%:%737=268%:%
%:%738=268%:%
%:%739=269%:%
%:%740=269%:%
%:%741=270%:%
%:%742=270%:%
%:%743=271%:%
%:%744=271%:%
%:%745=272%:%
%:%746=272%:%
%:%747=273%:%
%:%748=273%:%
%:%749=273%:%
%:%750=274%:%
%:%756=274%:%
%:%759=275%:%
%:%760=276%:%
%:%761=276%:%
%:%764=277%:%
%:%768=277%:%
%:%769=277%:%
%:%774=277%:%
%:%777=278%:%
%:%778=279%:%
%:%779=279%:%
%:%782=280%:%
%:%786=280%:%
%:%787=280%:%
%:%792=280%:%
%:%795=281%:%
%:%796=282%:%
%:%797=282%:%
%:%798=283%:%
%:%800=285%:%
%:%803=286%:%
%:%807=286%:%
%:%808=286%:%
%:%813=286%:%
%:%816=287%:%
%:%817=288%:%
%:%818=288%:%
%:%819=289%:%
%:%824=294%:%
%:%827=295%:%
%:%831=295%:%
%:%832=295%:%
%:%833=296%:%
%:%834=297%:%
%:%835=297%:%
%:%840=297%:%
%:%843=298%:%
%:%844=299%:%
%:%845=299%:%
%:%846=300%:%
%:%847=301%:%
%:%850=302%:%
%:%854=302%:%
%:%855=302%:%
%:%860=302%:%
%:%863=303%:%
%:%864=304%:%
%:%865=304%:%
%:%866=305%:%
%:%867=306%:%
%:%868=307%:%
%:%869=307%:%
%:%870=308%:%
%:%872=310%:%
%:%875=311%:%
%:%879=311%:%
%:%880=311%:%
%:%885=311%:%
%:%888=312%:%
%:%889=313%:%
%:%890=313%:%
%:%893=314%:%
%:%897=314%:%
%:%898=314%:%
%:%903=314%:%
%:%906=315%:%
%:%907=316%:%
%:%908=316%:%
%:%911=317%:%
%:%915=317%:%
%:%916=317%:%
%:%917=317%:%
%:%922=317%:%
%:%925=318%:%
%:%926=319%:%
%:%927=319%:%
%:%928=320%:%
%:%930=322%:%
%:%933=323%:%
%:%937=323%:%
%:%938=323%:%
%:%943=323%:%
%:%946=324%:%
%:%947=325%:%
%:%948=325%:%
%:%951=326%:%
%:%955=326%:%
%:%956=326%:%
%:%961=326%:%
%:%964=327%:%
%:%965=328%:%
%:%966=328%:%
%:%973=329%:%
%:%974=329%:%
%:%975=330%:%
%:%976=330%:%
%:%977=331%:%
%:%978=331%:%
%:%979=331%:%
%:%980=331%:%
%:%981=332%:%
%:%982=332%:%
%:%983=333%:%
%:%984=333%:%
%:%985=334%:%
%:%986=334%:%
%:%987=334%:%
%:%988=335%:%
%:%989=335%:%
%:%990=336%:%
%:%991=336%:%
%:%992=337%:%
%:%998=337%:%
%:%1001=338%:%
%:%1002=339%:%
%:%1003=339%:%
%:%1006=340%:%
%:%1010=340%:%
%:%1011=340%:%
%:%1012=341%:%
%:%1013=341%:%
%:%1018=341%:%
%:%1021=342%:%
%:%1022=343%:%
%:%1023=343%:%
%:%1026=344%:%
%:%1030=344%:%
%:%1031=344%:%
%:%1032=345%:%
%:%1033=345%:%
%:%1034=346%:%
%:%1035=346%:%
%:%1036=347%:%
%:%1037=347%:%
%:%1038=348%:%
%:%1039=348%:%
%:%1040=349%:%
%:%1041=349%:%
%:%1042=350%:%
%:%1043=350%:%
%:%1044=351%:%
%:%1045=351%:%
%:%1050=351%:%
%:%1053=352%:%
%:%1054=353%:%
%:%1055=353%:%
%:%1058=354%:%
%:%1062=354%:%
%:%1063=354%:%
%:%1064=355%:%
%:%1065=355%:%
%:%1066=356%:%
%:%1067=356%:%
%:%1068=357%:%
%:%1069=357%:%
%:%1070=358%:%
%:%1071=358%:%
%:%1076=358%:%
%:%1079=359%:%
%:%1080=360%:%
%:%1081=360%:%
%:%1084=361%:%
%:%1088=361%:%
%:%1089=361%:%
%:%1094=361%:%
%:%1097=362%:%
%:%1098=363%:%
%:%1099=363%:%
%:%1100=364%:%
%:%1101=365%:%
%:%1102=366%:%
%:%1103=366%:%
%:%1106=367%:%
%:%1110=367%:%
%:%1111=367%:%
%:%1112=368%:%
%:%1113=368%:%
%:%1114=369%:%
%:%1115=369%:%
%:%1116=370%:%
%:%1117=370%:%
%:%1118=371%:%
%:%1119=371%:%
%:%1120=372%:%
%:%1121=372%:%
%:%1122=373%:%
%:%1123=373%:%
%:%1124=374%:%
%:%1125=374%:%
%:%1126=375%:%
%:%1127=375%:%
%:%1128=376%:%
%:%1129=377%:%
%:%1130=377%:%
%:%1131=378%:%
%:%1132=378%:%
%:%1133=379%:%
%:%1134=379%:%
%:%1135=380%:%
%:%1136=380%:%
%:%1138=382%:%
%:%1139=383%:%
%:%1140=383%:%
%:%1145=383%:%
%:%1148=384%:%
%:%1149=385%:%
%:%1150=385%:%
%:%1153=386%:%
%:%1157=386%:%
%:%1158=386%:%
%:%1159=386%:%
%:%1164=386%:%
%:%1167=387%:%
%:%1168=388%:%
%:%1169=388%:%
%:%1170=389%:%
%:%1171=390%:%
%:%1174=391%:%
%:%1178=391%:%
%:%1179=391%:%
%:%1180=392%:%
%:%1181=392%:%
%:%1182=393%:%
%:%1183=393%:%
%:%1184=394%:%
%:%1185=394%:%
%:%1190=394%:%
%:%1193=395%:%
%:%1194=402%:%
%:%1195=403%:%
%:%1196=404%:%
%:%1197=404%:%
%:%1200=405%:%
%:%1204=405%:%
%:%1205=405%:%
%:%1206=405%:%
%:%1211=405%:%
%:%1214=406%:%
%:%1215=407%:%
%:%1216=407%:%
%:%1219=408%:%
%:%1223=408%:%
%:%1224=408%:%
%:%1225=408%:%
%:%1230=408%:%
%:%1233=409%:%
%:%1234=410%:%
%:%1235=410%:%
%:%1238=411%:%
%:%1242=411%:%
%:%1243=411%:%
%:%1248=411%:%
%:%1251=412%:%
%:%1252=413%:%
%:%1253=413%:%
%:%1260=414%:%
%:%1261=414%:%
%:%1262=415%:%
%:%1263=415%:%
%:%1264=416%:%
%:%1265=416%:%
%:%1266=416%:%
%:%1267=417%:%
%:%1268=417%:%
%:%1269=418%:%
%:%1270=418%:%
%:%1271=419%:%
%:%1272=419%:%
%:%1273=420%:%
%:%1274=420%:%
%:%1275=420%:%
%:%1276=421%:%
%:%1277=421%:%
%:%1278=422%:%
%:%1284=422%:%
%:%1287=423%:%
%:%1288=424%:%
%:%1289=424%:%
%:%1292=425%:%
%:%1296=425%:%
%:%1297=425%:%
%:%1302=425%:%
%:%1305=426%:%
%:%1306=427%:%
%:%1307=427%:%
%:%1310=428%:%
%:%1314=428%:%
%:%1315=428%:%
%:%1316=428%:%
%:%1321=428%:%
%:%1324=429%:%
%:%1325=430%:%
%:%1326=430%:%
%:%1329=431%:%
%:%1333=431%:%
%:%1334=431%:%
%:%1335=431%:%
%:%1340=431%:%
%:%1343=432%:%
%:%1344=433%:%
%:%1345=433%:%
%:%1346=434%:%
%:%1347=435%:%
%:%1348=436%:%
%:%1349=437%:%
%:%1350=438%:%
%:%1351=438%:%
%:%1354=439%:%
%:%1358=439%:%
%:%1359=439%:%
%:%1360=440%:%
%:%1361=440%:%
%:%1362=441%:%
%:%1363=441%:%
%:%1368=441%:%
%:%1371=442%:%
%:%1372=443%:%
%:%1373=443%:%
%:%1374=444%:%
%:%1375=445%:%
%:%1384=454%:%
%:%1385=455%:%
%:%1386=456%:%
%:%1387=456%:%
%:%1394=457%:%
%:%1395=457%:%
%:%1396=458%:%
%:%1397=458%:%
%:%1398=459%:%
%:%1399=459%:%
%:%1400=459%:%
%:%1401=460%:%
%:%1402=460%:%
%:%1403=460%:%
%:%1404=461%:%
%:%1405=461%:%
%:%1406=462%:%
%:%1407=462%:%
%:%1408=463%:%
%:%1409=463%:%
%:%1410=463%:%
%:%1411=464%:%
%:%1412=464%:%
%:%1413=465%:%
%:%1414=465%:%
%:%1415=466%:%
%:%1416=466%:%
%:%1417=467%:%
%:%1418=467%:%
%:%1419=468%:%
%:%1420=468%:%
%:%1421=469%:%
%:%1422=469%:%
%:%1423=470%:%
%:%1424=470%:%
%:%1425=471%:%
%:%1426=471%:%
%:%1427=472%:%
%:%1428=472%:%
%:%1429=473%:%
%:%1430=473%:%
%:%1431=474%:%
%:%1432=474%:%
%:%1433=475%:%
%:%1434=475%:%
%:%1436=477%:%
%:%1437=478%:%
%:%1438=478%:%
%:%1439=479%:%
%:%1440=479%:%
%:%1441=480%:%
%:%1442=480%:%
%:%1443=481%:%
%:%1444=481%:%
%:%1445=482%:%
%:%1451=482%:%
%:%1454=483%:%
%:%1455=484%:%
%:%1456=484%:%
%:%1459=485%:%
%:%1463=485%:%
%:%1464=485%:%
%:%1465=485%:%
%:%1470=485%:%
%:%1473=486%:%
%:%1474=487%:%
%:%1475=487%:%
%:%1478=488%:%
%:%1482=488%:%
%:%1483=488%:%
%:%1488=488%:%
%:%1493=489%:%
%:%1498=490%:%