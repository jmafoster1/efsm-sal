%
\begin{isabellebody}%
\setisabellecontext{Stream}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Infinite Streams%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Stream\isanewline
\ \ \isakeyword{imports}\ Nat{\isacharunderscore}Bijection\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isacommand{codatatype}\isamarkupfalse%
\ {\isacharparenleft}sset{\isacharcolon}\ {\isacharprime}a{\isacharparenright}\ stream\ {\isacharequal}\isanewline
\ \ SCons\ {\isacharparenleft}shd{\isacharcolon}\ {\isacharprime}a{\isacharparenright}\ {\isacharparenleft}stl{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ stream{\isachardoublequoteclose}{\isacharparenright}\ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isacharhash}{\isacharhash}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}\isanewline
\isakeyword{for}\isanewline
\ \ map{\isacharcolon}\ smap\isanewline
\ \ rel{\isacharcolon}\ stream{\isacharunderscore}all{\isadigit{2}}\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\isanewline
\isakeyword{begin}\isanewline
\isanewline
%
\isamarkupcmt{for code generation only%
}\isanewline
\isakeyword{qualified}\ \isacommand{definition}\isamarkupfalse%
\ smember\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ {\isasymRightarrow}\ {\isacharprime}a\ stream\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isacharbrackleft}code{\isacharunderscore}abbrev{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}smember\ x\ s\ {\isasymlongleftrightarrow}\ x\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smember{\isacharunderscore}code{\isacharbrackleft}code{\isacharcomma}\ simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}smember\ x\ {\isacharparenleft}y\ {\isacharhash}{\isacharhash}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ x\ {\isacharequal}\ y\ then\ True\ else\ smember\ x\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ smember{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ smap{\isacharunderscore}simps{\isacharbrackleft}simp{\isacharbrackright}\ {\isacharequal}\ stream{\isachardot}map{\isacharunderscore}sel\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ shd{\isacharunderscore}sset\ {\isacharequal}\ stream{\isachardot}set{\isacharunderscore}sel{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ stl{\isacharunderscore}sset\ {\isacharequal}\ stream{\isachardot}set{\isacharunderscore}sel{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\isanewline
\isacommand{theorem}\isamarkupfalse%
\ sset{\isacharunderscore}induct{\isacharbrackleft}consumes\ {\isadigit{1}}{\isacharcomma}\ case{\isacharunderscore}names\ shd\ stl{\isacharcomma}\ induct\ set{\isacharcolon}\ sset{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}y\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}s{\isachardot}\ P\ {\isacharparenleft}shd\ s{\isacharparenright}\ s{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}s\ y{\isachardot}\ {\isasymlbrakk}y\ {\isasymin}\ sset\ {\isacharparenleft}stl\ s{\isacharparenright}{\isacharsemicolon}\ P\ y\ {\isacharparenleft}stl\ s{\isacharparenright}{\isasymrbrakk}\ {\isasymLongrightarrow}\ P\ y\ s{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}P\ y\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ induct\ {\isacharparenleft}metis\ stream{\isachardot}sel{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharcomma}\ auto{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}ctr{\isacharcolon}\ {\isachardoublequoteopen}smap\ f\ s\ {\isacharequal}\ x\ {\isacharhash}{\isacharhash}\ s{\isacharprime}\ {\isasymlongleftrightarrow}\ f\ {\isacharparenleft}shd\ s{\isacharparenright}\ {\isacharequal}\ x\ {\isasymand}\ smap\ f\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isacharequal}\ s{\isacharprime}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{prepend list to stream%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primrec}\isamarkupfalse%
\ shift\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ list\ {\isasymRightarrow}\ {\isacharprime}a\ stream\ {\isasymRightarrow}\ {\isacharprime}a\ stream{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{infixr}\ {\isachardoublequoteopen}{\isacharat}{\isacharminus}{\isachardoublequoteclose}\ {\isadigit{6}}{\isadigit{5}}{\isacharparenright}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shift\ {\isacharbrackleft}{\isacharbrackright}\ s\ {\isacharequal}\ s{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}shift\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ s\ {\isacharequal}\ x\ {\isacharhash}{\isacharhash}\ shift\ xs\ s{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}shift{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}smap\ f\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ map\ f\ xs\ {\isacharat}{\isacharminus}\ smap\ f\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ xs{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}append{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}xs\ {\isacharat}\ ys{\isacharparenright}\ {\isacharat}{\isacharminus}\ s\ {\isacharequal}\ xs\ {\isacharat}{\isacharminus}\ ys\ {\isacharat}{\isacharminus}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ xs{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}simps{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ xs\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ then\ shd\ s\ else\ hd\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ {\isachardoublequoteopen}stl\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ xs\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ then\ stl\ s\ else\ tl\ xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ xs{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}shift{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ set\ xs\ {\isasymunion}\ sset\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ xs{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}left{\isacharunderscore}inj{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}xs\ {\isacharat}{\isacharminus}\ s{\isadigit{1}}\ {\isacharequal}\ xs\ {\isacharat}{\isacharminus}\ s{\isadigit{2}}\ {\isasymlongleftrightarrow}\ s{\isadigit{1}}\ {\isacharequal}\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ xs{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{set of streams with elements in some fixed set%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{notes}\ {\isacharbrackleft}{\isacharbrackleft}inductive{\isacharunderscore}internals{\isacharbrackright}{\isacharbrackright}\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{coinductive{\isacharunderscore}set}\isamarkupfalse%
\isanewline
\ \ streams\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ set\ {\isasymRightarrow}\ {\isacharprime}a\ stream\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{for}\ A\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ set{\isachardoublequoteclose}\isanewline
\isakeyword{where}\isanewline
\ \ Stream{\isacharbrackleft}intro{\isacharbang}{\isacharcomma}\ simp{\isacharcomma}\ no{\isacharunderscore}atp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymlbrakk}a\ {\isasymin}\ A{\isacharsemicolon}\ s\ {\isasymin}\ streams\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\ a\ {\isacharhash}{\isacharhash}\ s\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ in{\isacharunderscore}streams{\isacharcolon}\ {\isachardoublequoteopen}stl\ s\ {\isasymin}\ streams\ S\ {\isasymLongrightarrow}\ shd\ s\ {\isasymin}\ S\ {\isasymLongrightarrow}\ s\ {\isasymin}\ streams\ S{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streamsE{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A\ {\isasymLongrightarrow}\ {\isacharparenleft}shd\ s\ {\isasymin}\ A\ {\isasymLongrightarrow}\ stl\ s\ {\isasymin}\ streams\ A\ {\isasymLongrightarrow}\ P{\isacharparenright}\ {\isasymLongrightarrow}\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}erule\ streams{\isachardot}cases{\isacharparenright}\ simp{\isacharunderscore}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ Stream{\isacharunderscore}image{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharhash}{\isacharhash}\ y\ {\isasymin}\ {\isacharparenleft}{\isacharparenleft}{\isacharhash}{\isacharhash}{\isacharparenright}\ x{\isacharprime}{\isacharparenright}\ {\isacharbackquote}\ Y\ {\isasymlongleftrightarrow}\ x\ {\isacharequal}\ x{\isacharprime}\ {\isasymand}\ y\ {\isasymin}\ Y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}streams{\isacharcolon}\ {\isachardoublequoteopen}{\isasymlbrakk}w\ {\isasymin}\ lists\ A{\isacharsemicolon}\ s\ {\isasymin}\ streams\ A{\isasymrbrakk}\ {\isasymLongrightarrow}\ w\ {\isacharat}{\isacharminus}\ s\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ w{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}Stream{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isacharhash}{\isacharhash}\ s\ {\isasymin}\ streams\ A\ {\isasymlongleftrightarrow}\ x\ {\isasymin}\ A\ {\isasymand}\ s\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ elim{\isacharcolon}\ streams{\isachardot}cases{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}stl{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A\ {\isasymLongrightarrow}\ stl\ s\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ streams{\isacharunderscore}Stream{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}shd{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A\ {\isasymLongrightarrow}\ shd\ s\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ streams{\isacharunderscore}Stream{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}streams{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}sset\ s\ {\isasymsubseteq}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ s{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ streams\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}sset{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sset\ s\ {\isasymsubseteq}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\ \isacommand{from}\isamarkupfalse%
\ this\ {\isacartoucheopen}s\ {\isasymin}\ streams\ A{\isacartoucheclose}\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ s{\isacharparenright}\ {\isacharparenleft}auto\ intro{\isacharcolon}\ streams{\isacharunderscore}shd\ streams{\isacharunderscore}stl{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}iff{\isacharunderscore}sset{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A\ {\isasymlongleftrightarrow}\ sset\ s\ {\isasymsubseteq}\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ sset{\isacharunderscore}streams\ streams{\isacharunderscore}sset{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}mono{\isacharcolon}\ \ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A\ {\isasymLongrightarrow}\ A\ {\isasymsubseteq}\ B\ {\isasymLongrightarrow}\ s\ {\isasymin}\ streams\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ streams{\isacharunderscore}iff{\isacharunderscore}sset\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}mono{\isadigit{2}}{\isacharcolon}\ {\isachardoublequoteopen}S\ {\isasymsubseteq}\ T\ {\isasymLongrightarrow}\ streams\ S\ {\isasymsubseteq}\ streams\ T{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ streams{\isacharunderscore}mono{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}streams{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ A\ {\isasymLongrightarrow}\ {\isacharparenleft}{\isasymAnd}x{\isachardot}\ x\ {\isasymin}\ A\ {\isasymLongrightarrow}\ f\ x\ {\isasymin}\ B{\isacharparenright}\ {\isasymLongrightarrow}\ smap\ f\ s\ {\isasymin}\ streams\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ streams{\isacharunderscore}iff{\isacharunderscore}sset\ stream{\isachardot}set{\isacharunderscore}map\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}empty{\isacharcolon}\ {\isachardoublequoteopen}streams\ {\isacharbraceleft}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ elim{\isacharcolon}\ streams{\isachardot}cases{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}UNIV{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}streams\ UNIV\ {\isacharequal}\ UNIV{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ streams{\isacharunderscore}iff{\isacharunderscore}sset{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{nth, take, drop for streams%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primrec}\isamarkupfalse%
\ snth\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ stream\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}a{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{infixl}\ {\isachardoublequoteopen}{\isacharbang}{\isacharbang}{\isachardoublequoteclose}\ {\isadigit{1}}{\isadigit{0}}{\isadigit{0}}{\isacharparenright}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}s\ {\isacharbang}{\isacharbang}\ {\isadigit{0}}\ {\isacharequal}\ shd\ s{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}s\ {\isacharbang}{\isacharbang}\ Suc\ n\ {\isacharequal}\ stl\ s\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}Stream{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}x\ {\isacharhash}{\isacharhash}\ s{\isacharparenright}\ {\isacharbang}{\isacharbang}\ Suc\ i\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ i{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}smap{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}smap\ f\ s\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ f\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}snth{\isacharunderscore}less{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isacharless}\ length\ xs\ {\isasymLongrightarrow}\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharbang}{\isacharbang}\ p\ {\isacharequal}\ xs\ {\isacharbang}\ p{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ p\ arbitrary{\isacharcolon}\ xs{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ hd{\isacharunderscore}conv{\isacharunderscore}nth\ nth{\isacharunderscore}tl{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}snth{\isacharunderscore}ge{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}p\ {\isasymge}\ length\ xs\ {\isasymLongrightarrow}\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharbang}{\isacharbang}\ p\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}p\ {\isacharminus}\ length\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ p\ arbitrary{\isacharcolon}\ xs{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ Suc{\isacharunderscore}diff{\isacharunderscore}eq{\isacharunderscore}diff{\isacharunderscore}pred{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}snth{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ {\isacharparenleft}if\ n\ {\isacharless}\ length\ xs\ then\ xs\ {\isacharbang}\ n\ else\ s\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}n\ {\isacharminus}\ length\ xs{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}sset{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isacharbang}{\isacharbang}\ n\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ {\isacharparenleft}auto\ intro{\isacharcolon}\ shd{\isacharunderscore}sset\ stl{\isacharunderscore}sset{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}range{\isacharcolon}\ {\isachardoublequoteopen}sset\ s\ {\isacharequal}\ range\ {\isacharparenleft}snth\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}intro\ equalityI\ subsetI{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ range\ {\isacharparenleft}snth\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ s{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}stl\ s\ x{\isacharparenright}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ stl\ s\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ range{\isacharunderscore}eqI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isacharunderscore}\ {\isachardoublequoteopen}Suc\ n{\isachardoublequoteclose}{\isacharbrackright}{\isacharparenright}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharcolon}\ range{\isacharunderscore}eqI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isacharunderscore}\ {\isadigit{0}}{\isacharbrackright}{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}iff{\isacharunderscore}snth{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ X\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\isasymforall}n{\isachardot}\ s\ {\isacharbang}{\isacharbang}\ n\ {\isasymin}\ X{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}force\ simp{\isacharcolon}\ streams{\isacharunderscore}iff{\isacharunderscore}sset\ sset{\isacharunderscore}range{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}in{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isasymin}\ streams\ X\ {\isasymLongrightarrow}\ s\ {\isacharbang}{\isacharbang}\ n\ {\isasymin}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ streams{\isacharunderscore}iff{\isacharunderscore}snth{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ stake\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}a\ stream\ {\isasymRightarrow}\ {\isacharprime}a\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}stake\ {\isadigit{0}}\ s\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stake\ {\isacharparenleft}Suc\ n{\isacharparenright}\ s\ {\isacharequal}\ shd\ s\ {\isacharhash}\ stake\ n\ {\isacharparenleft}stl\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ length{\isacharunderscore}stake{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}stake\ n\ s{\isacharparenright}\ {\isacharequal}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}smap{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}stake\ n\ {\isacharparenleft}smap\ f\ s{\isacharparenright}\ {\isacharequal}\ map\ f\ {\isacharparenleft}stake\ n\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ take{\isacharunderscore}stake{\isacharcolon}\ {\isachardoublequoteopen}take\ n\ {\isacharparenleft}stake\ m\ s{\isacharparenright}\ {\isacharequal}\ stake\ {\isacharparenleft}min\ n\ m{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ m\ arbitrary{\isacharcolon}\ s\ n{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ m{\isacharparenright}\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ n{\isacharparenright}\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primrec}\isamarkupfalse%
\ sdrop\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}a\ stream\ {\isasymRightarrow}\ {\isacharprime}a\ stream{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}sdrop\ {\isadigit{0}}\ s\ {\isacharequal}\ s{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}sdrop\ {\isacharparenleft}Suc\ n{\isacharparenright}\ s\ {\isacharequal}\ sdrop\ n\ {\isacharparenleft}stl\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}simps{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}sdrop\ n\ s{\isacharparenright}\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}sdrop\ n\ s{\isacharparenright}\ {\isacharequal}\ sdrop\ {\isacharparenleft}Suc\ n{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ \ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}smap{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ n\ {\isacharparenleft}smap\ f\ s{\isacharparenright}\ {\isacharequal}\ smap\ f\ {\isacharparenleft}sdrop\ n\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}stl{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ n\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isacharequal}\ stl\ {\isacharparenleft}sdrop\ n\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ drop{\isacharunderscore}stake{\isacharcolon}\ {\isachardoublequoteopen}drop\ n\ {\isacharparenleft}stake\ m\ s{\isacharparenright}\ {\isacharequal}\ stake\ {\isacharparenleft}m\ {\isacharminus}\ n{\isacharparenright}\ {\isacharparenleft}sdrop\ n\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ m\ arbitrary{\isacharcolon}\ s\ n{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ m{\isacharparenright}\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ n{\isacharparenright}\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}sdrop{\isacharcolon}\ {\isachardoublequoteopen}stake\ n\ s\ {\isacharat}{\isacharminus}\ sdrop\ n\ s\ {\isacharequal}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ id{\isacharunderscore}stake{\isacharunderscore}snth{\isacharunderscore}sdrop{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}s\ {\isacharequal}\ stake\ i\ s\ {\isacharat}{\isacharminus}\ s\ {\isacharbang}{\isacharbang}\ i\ {\isacharhash}{\isacharhash}\ sdrop\ {\isacharparenleft}Suc\ i{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ stake{\isacharunderscore}sdrop{\isacharbrackleft}symmetric{\isacharcomma}\ of\ {\isacharunderscore}\ i{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}metis\ sdrop{\isacharunderscore}simps\ stream{\isachardot}collapse{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}alt{\isacharcolon}\ {\isachardoublequoteopen}smap\ f\ s\ {\isacharequal}\ s{\isacharprime}\ {\isasymlongleftrightarrow}\ {\isacharparenleft}{\isasymforall}n{\isachardot}\ f\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}\ {\isacharequal}\ s{\isacharprime}\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}L\ {\isacharequal}\ {\isacharquery}R{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isacharquery}R\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}n{\isachardot}\ smap\ f\ {\isacharparenleft}sdrop\ n\ s{\isacharparenright}\ {\isacharequal}\ sdrop\ n\ s{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ coinduction\ {\isacharparenleft}auto\ intro{\isacharcolon}\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isadigit{0}}{\isacharbrackright}\ simp\ del{\isacharcolon}\ sdrop{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}L\ \isacommand{using}\isamarkupfalse%
\ sdrop{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}invert{\isacharunderscore}Nil{\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}stake\ n\ s\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymlongleftrightarrow}\ n\ {\isacharequal}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}shift{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ i\ {\isacharparenleft}w\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ drop\ i\ w\ {\isacharat}{\isacharminus}\ sdrop\ {\isacharparenleft}i\ {\isacharminus}\ length\ w{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ i\ arbitrary{\isacharcolon}\ w\ s{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ drop{\isacharunderscore}tl\ drop{\isacharunderscore}Suc\ neq{\isacharunderscore}Nil{\isacharunderscore}conv{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}shift{\isacharcolon}\ {\isachardoublequoteopen}stake\ i\ {\isacharparenleft}w\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ take\ i\ w\ {\isacharat}\ stake\ {\isacharparenleft}i\ {\isacharminus}\ length\ w{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ i\ arbitrary{\isacharcolon}\ w\ s{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ neq{\isacharunderscore}Nil{\isacharunderscore}conv{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}add{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}stake\ m\ s\ {\isacharat}\ stake\ n\ {\isacharparenleft}sdrop\ m\ s{\isacharparenright}\ {\isacharequal}\ stake\ {\isacharparenleft}m\ {\isacharplus}\ n{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ m\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}add{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ n\ {\isacharparenleft}sdrop\ m\ s{\isacharparenright}\ {\isacharequal}\ sdrop\ {\isacharparenleft}m\ {\isacharplus}\ n{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ m\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}snth{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ n\ s\ {\isacharbang}{\isacharbang}\ m\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}n\ {\isacharplus}\ m{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ m\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{partial{\isacharunderscore}function}\isamarkupfalse%
\ {\isacharparenleft}tailrec{\isacharparenright}\ sdrop{\isacharunderscore}while\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}{\isacharprime}a\ {\isasymRightarrow}\ bool{\isacharparenright}\ {\isasymRightarrow}\ {\isacharprime}a\ stream\ {\isasymRightarrow}\ {\isacharprime}a\ stream{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}sdrop{\isacharunderscore}while\ P\ s\ {\isacharequal}\ {\isacharparenleft}if\ P\ {\isacharparenleft}shd\ s{\isacharparenright}\ then\ sdrop{\isacharunderscore}while\ P\ {\isacharparenleft}stl\ s{\isacharparenright}\ else\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}while{\isacharunderscore}SCons{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sdrop{\isacharunderscore}while\ P\ {\isacharparenleft}a\ {\isacharhash}{\isacharhash}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ P\ a\ then\ sdrop{\isacharunderscore}while\ P\ s\ else\ a\ {\isacharhash}{\isacharhash}\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sdrop{\isacharunderscore}while{\isachardot}simps{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}while{\isacharunderscore}sdrop{\isacharunderscore}LEAST{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}\ P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sdrop{\isacharunderscore}while\ {\isacharparenleft}Not\ {\isasymcirc}\ P{\isacharparenright}\ s\ {\isacharequal}\ sdrop\ {\isacharparenleft}LEAST\ n{\isachardot}\ P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ assms\ \isacommand{obtain}\isamarkupfalse%
\ m\ \isakeyword{where}\ {\isachardoublequoteopen}P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ m{\isacharparenright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymAnd}n{\isachardot}\ P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}\ {\isasymLongrightarrow}\ m\ {\isasymle}\ n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}LEAST\ n{\isachardot}\ P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ {\isacharequal}\ m{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ atomize{\isacharunderscore}elim\ {\isacharparenleft}auto\ intro{\isacharcolon}\ LeastI\ Least{\isacharunderscore}le{\isacharparenright}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ {\isacharasterisk}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ m\ arbitrary{\isacharcolon}\ s{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ m{\isacharparenright}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sdrop{\isacharunderscore}while\ {\isacharparenleft}Not\ {\isasymcirc}\ P{\isacharparenright}\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isacharequal}\ sdrop\ m\ {\isacharparenleft}stl\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ {\isacharparenleft}full{\isacharunderscore}types{\isacharparenright}\ not{\isacharunderscore}less{\isacharunderscore}eq{\isacharunderscore}eq\ snth{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ Suc{\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ {\isadigit{0}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sdrop{\isacharunderscore}while{\isachardot}simps{\isacharparenright}\ simp\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}metis\ comp{\isacharunderscore}apply\ sdrop{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ sdrop{\isacharunderscore}while{\isachardot}simps\ snth{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{primcorec}\isamarkupfalse%
\ sfilter\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}sfilter\ P\ s{\isacharparenright}\ {\isacharequal}\ shd\ {\isacharparenleft}sdrop{\isacharunderscore}while\ {\isacharparenleft}Not\ {\isasymcirc}\ P{\isacharparenright}\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}sfilter\ P\ s{\isacharparenright}\ {\isacharequal}\ sfilter\ P\ {\isacharparenleft}stl\ {\isacharparenleft}sdrop{\isacharunderscore}while\ {\isacharparenleft}Not\ {\isasymcirc}\ P{\isacharparenright}\ s{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sfilter{\isacharunderscore}Stream{\isacharcolon}\ {\isachardoublequoteopen}sfilter\ P\ {\isacharparenleft}x\ {\isacharhash}{\isacharhash}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}if\ P\ x\ then\ x\ {\isacharhash}{\isacharhash}\ sfilter\ P\ s\ else\ sfilter\ P\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}P\ x{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sfilter{\isachardot}ctr{\isacharparenright}\ {\isacharparenleft}simp\ add{\isacharcolon}\ sdrop{\isacharunderscore}while{\isacharunderscore}SCons{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}{\isadigit{1}}\ {\isadigit{2}}{\isacharparenright}\ sfilter{\isachardot}ctr{\isacharparenright}\ {\isacharparenleft}simp\ add{\isacharcolon}\ sdrop{\isacharunderscore}while{\isacharunderscore}SCons{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{unary predicates lifted to streams%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}stream{\isacharunderscore}all\ P\ s\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}p{\isachardot}\ P\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ p{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stream{\isacharunderscore}all{\isacharunderscore}iff{\isacharbrackleft}iff{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}stream{\isacharunderscore}all\ P\ s\ {\isasymlongleftrightarrow}\ Ball\ {\isacharparenleft}sset\ s{\isacharparenright}\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ stream{\isacharunderscore}all{\isacharunderscore}def\ sset{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stream{\isacharunderscore}all{\isacharunderscore}shift{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}stream{\isacharunderscore}all\ P\ {\isacharparenleft}xs\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}list{\isacharunderscore}all\ P\ xs\ {\isasymand}\ stream{\isacharunderscore}all\ P\ s{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ stream{\isacharunderscore}all{\isacharunderscore}iff\ list{\isacharunderscore}all{\isacharunderscore}iff\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stream{\isacharunderscore}all{\isacharunderscore}Stream{\isacharcolon}\ {\isachardoublequoteopen}stream{\isacharunderscore}all\ P\ {\isacharparenleft}x\ {\isacharhash}{\isacharhash}\ X{\isacharparenright}\ {\isasymlongleftrightarrow}\ P\ x\ {\isasymand}\ stream{\isacharunderscore}all\ P\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{recurring stream out of a list%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primcorec}\isamarkupfalse%
\ cycle\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ list\ {\isasymRightarrow}\ {\isacharprime}a\ stream{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}cycle\ xs{\isacharparenright}\ {\isacharequal}\ hd\ xs{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}cycle\ xs{\isacharparenright}\ {\isacharequal}\ cycle\ {\isacharparenleft}tl\ xs\ {\isacharat}\ {\isacharbrackleft}hd\ xs{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cycle{\isacharunderscore}decomp{\isacharcolon}\ {\isachardoublequoteopen}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ cycle\ u\ {\isacharequal}\ u\ {\isacharat}{\isacharminus}\ cycle\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ u{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Eq{\isacharunderscore}stream\ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{using}\isamarkupfalse%
\ stream{\isachardot}collapse{\isacharbrackleft}of\ {\isachardoublequoteopen}cycle\ u{\isachardoublequoteclose}{\isacharbrackright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ intro{\isacharbang}{\isacharcolon}\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isachardoublequoteopen}tl\ u\ {\isacharat}\ {\isacharbrackleft}hd\ u{\isacharbrackright}{\isachardoublequoteclose}{\isacharbrackright}{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cycle{\isacharunderscore}Cons{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}cycle\ {\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharequal}\ x\ {\isacharhash}{\isacharhash}\ cycle\ {\isacharparenleft}xs\ {\isacharat}\ {\isacharbrackleft}x{\isacharbrackright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ cycle{\isachardot}ctr{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ cycle{\isacharunderscore}rotated{\isacharcolon}\ {\isachardoublequoteopen}{\isasymlbrakk}v\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharsemicolon}\ cycle\ u\ {\isacharequal}\ v\ {\isacharat}{\isacharminus}\ s{\isasymrbrakk}\ {\isasymLongrightarrow}\ cycle\ {\isacharparenleft}tl\ u\ {\isacharat}\ {\isacharbrackleft}hd\ u{\isacharbrackright}{\isacharparenright}\ {\isacharequal}\ tl\ v\ {\isacharat}{\isacharminus}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ dest{\isacharcolon}\ arg{\isacharunderscore}cong{\isacharbrackleft}of\ {\isacharunderscore}\ {\isacharunderscore}\ stl{\isacharbrackright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}append{\isacharcolon}\ {\isachardoublequoteopen}stake\ n\ {\isacharparenleft}u\ {\isacharat}{\isacharminus}\ s{\isacharparenright}\ {\isacharequal}\ take\ {\isacharparenleft}min\ {\isacharparenleft}length\ u{\isacharparenright}\ n{\isacharparenright}\ u\ {\isacharat}\ stake\ {\isacharparenleft}n\ {\isacharminus}\ length\ u{\isacharparenright}\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ u{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}Suc\ n{\isacharparenright}\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ u{\isacharparenright}\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}cycle{\isacharunderscore}le{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ {\isachardoublequoteopen}n\ {\isacharless}\ length\ u{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}stake\ n\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ take\ n\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ min{\isacharunderscore}absorb{\isadigit{2}}{\isacharbrackleft}OF\ less{\isacharunderscore}imp{\isacharunderscore}le{\isacharunderscore}nat{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharbrackright}{\isacharbrackright}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ cycle{\isacharunderscore}decomp{\isacharbrackleft}OF\ assms{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharbrackright}{\isacharcomma}\ subst\ stake{\isacharunderscore}append{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}cycle{\isacharunderscore}eq{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ stake\ {\isacharparenleft}length\ u{\isacharparenright}\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ cycle{\isacharunderscore}decomp{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ stake{\isacharunderscore}shift{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}cycle{\isacharunderscore}eq{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ sdrop\ {\isacharparenleft}length\ u{\isacharparenright}\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ cycle\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ cycle{\isacharunderscore}decomp{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sdrop{\isacharunderscore}shift{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}cycle{\isacharunderscore}eq{\isacharunderscore}mod{\isacharunderscore}{\isadigit{0}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymlbrakk}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharsemicolon}\ n\ mod\ length\ u\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ stake\ n\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ concat\ {\isacharparenleft}replicate\ {\isacharparenleft}n\ div\ length\ u{\isacharparenright}\ u{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ {\isachardoublequoteopen}n\ div\ length\ u{\isachardoublequoteclose}\ arbitrary{\isacharcolon}\ n\ u{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}auto\ simp{\isacharcolon}\ stake{\isacharunderscore}add\ {\isacharbrackleft}symmetric{\isacharbrackright}\ mod{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}iff{\isacharunderscore}dvd\ elim{\isacharbang}{\isacharcolon}\ dvdE{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}cycle{\isacharunderscore}eq{\isacharunderscore}mod{\isacharunderscore}{\isadigit{0}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymlbrakk}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isacharsemicolon}\ n\ mod\ length\ u\ {\isacharequal}\ {\isadigit{0}}{\isasymrbrakk}\ {\isasymLongrightarrow}\isanewline
\ \ \ sdrop\ n\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ cycle\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ {\isachardoublequoteopen}n\ div\ length\ u{\isachardoublequoteclose}\ arbitrary{\isacharcolon}\ n\ u{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}auto\ simp{\isacharcolon}\ sdrop{\isacharunderscore}add\ {\isacharbrackleft}symmetric{\isacharbrackright}\ mod{\isacharunderscore}eq{\isacharunderscore}{\isadigit{0}}{\isacharunderscore}iff{\isacharunderscore}dvd\ elim{\isacharbang}{\isacharcolon}\ dvdE{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}cycle{\isacharcolon}\ {\isachardoublequoteopen}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\isanewline
\ \ \ stake\ n\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ concat\ {\isacharparenleft}replicate\ {\isacharparenleft}n\ div\ length\ u{\isacharparenright}\ u{\isacharparenright}\ {\isacharat}\ take\ {\isacharparenleft}n\ mod\ length\ u{\isacharparenright}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ div{\isacharunderscore}mult{\isacharunderscore}mod{\isacharunderscore}eq{\isacharbrackleft}of\ n\ {\isachardoublequoteopen}length\ u{\isachardoublequoteclose}{\isacharcomma}\ symmetric{\isacharbrackright}{\isacharcomma}\ unfold\ stake{\isacharunderscore}add{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}cycle{\isacharcolon}\ {\isachardoublequoteopen}u\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ sdrop\ n\ {\isacharparenleft}cycle\ u{\isacharparenright}\ {\isacharequal}\ cycle\ {\isacharparenleft}rotate\ {\isacharparenleft}n\ mod\ length\ u{\isacharparenright}\ u{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ u{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ rotate{\isadigit{1}}{\isacharunderscore}rotate{\isacharunderscore}swap\ rotate{\isadigit{1}}{\isacharunderscore}hd{\isacharunderscore}tl\ rotate{\isacharunderscore}conv{\isacharunderscore}mod{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}cycle{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}cycle\ xs{\isacharparenright}\ {\isacharequal}\ set\ xs{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}intro\ set{\isacharunderscore}eqI\ iffI{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ {\isacharparenleft}cycle\ xs{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induction\ {\isachardoublequoteopen}cycle\ xs{\isachardoublequoteclose}\ arbitrary{\isacharcolon}\ xs\ rule{\isacharcolon}\ sset{\isacharunderscore}induct{\isacharparenright}\ {\isacharparenleft}fastforce\ simp{\isacharcolon}\ neq{\isacharunderscore}Nil{\isacharunderscore}conv{\isacharparenright}{\isacharplus}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}metis\ assms\ UnI{\isadigit{1}}\ cycle{\isacharunderscore}decomp\ sset{\isacharunderscore}shift{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{iterated application of a function%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primcorec}\isamarkupfalse%
\ siterate\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}siterate\ f\ x{\isacharparenright}\ {\isacharequal}\ x{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}siterate\ f\ x{\isacharparenright}\ {\isacharequal}\ siterate\ f\ {\isacharparenleft}f\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}Suc{\isacharcolon}\ {\isachardoublequoteopen}stake\ {\isacharparenleft}Suc\ n{\isacharparenright}\ s\ {\isacharequal}\ stake\ n\ s\ {\isacharat}\ {\isacharbrackleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}siterate{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}siterate\ f\ x\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ {\isacharparenleft}f{\isacharcircum}{\isacharcircum}n{\isacharparenright}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ x{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ funpow{\isacharunderscore}swap{\isadigit{1}}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}siterate{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ n\ {\isacharparenleft}siterate\ f\ x{\isacharparenright}\ {\isacharequal}\ siterate\ f\ {\isacharparenleft}{\isacharparenleft}f{\isacharcircum}{\isacharcircum}n{\isacharparenright}\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ x{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ funpow{\isacharunderscore}swap{\isadigit{1}}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}siterate{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}stake\ n\ {\isacharparenleft}siterate\ f\ x{\isacharparenright}\ {\isacharequal}\ map\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ {\isacharparenleft}f{\isacharcircum}{\isacharcircum}n{\isacharparenright}\ x{\isacharparenright}\ {\isacharbrackleft}{\isadigit{0}}\ {\isachardot}{\isachardot}{\isacharless}\ n{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ x{\isacharparenright}\ {\isacharparenleft}auto\ simp\ del{\isacharcolon}\ stake{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ simp{\isacharcolon}\ stake{\isacharunderscore}Suc{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}siterate{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}siterate\ f\ x{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}{\isacharparenleft}f{\isacharcircum}{\isacharcircum}n{\isacharparenright}\ x\ {\isacharbar}\ n{\isachardot}\ True{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sset{\isacharunderscore}range{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}siterate{\isacharcolon}\ {\isachardoublequoteopen}smap\ f\ {\isacharparenleft}siterate\ f\ x{\isacharparenright}\ {\isacharequal}\ siterate\ f\ {\isacharparenleft}f\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ x{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{stream repeating a single element%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}sconst\ {\isasymequiv}\ siterate\ id{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ shift{\isacharunderscore}replicate{\isacharunderscore}sconst{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}replicate\ n\ x\ {\isacharat}{\isacharminus}\ sconst\ x\ {\isacharequal}\ sconst\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}{\isadigit{3}}{\isacharparenright}\ stake{\isacharunderscore}sdrop{\isacharbrackleft}symmetric{\isacharbrackright}{\isacharparenright}\ {\isacharparenleft}simp\ add{\isacharcolon}\ map{\isacharunderscore}replicate{\isacharunderscore}trivial{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}sconst{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}sconst\ x{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}x{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ sset{\isacharunderscore}siterate{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sconst{\isacharunderscore}alt{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isacharequal}\ sconst\ x\ {\isasymlongleftrightarrow}\ sset\ s\ {\isacharequal}\ {\isacharbraceleft}x{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}sset\ s\ {\isacharequal}\ {\isacharbraceleft}x{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isacharequal}\ sconst\ x{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ s{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Eq{\isacharunderscore}stream\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}shd\ s\ {\isacharequal}\ x{\isachardoublequoteclose}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isasymsubseteq}\ {\isacharbraceleft}x{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharsemicolon}\ auto{\isacharparenright}{\isacharplus}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sset\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}x{\isacharbraceright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}stl\ s{\isachardoublequoteclose}{\isacharparenright}\ auto\isanewline
\ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}shd\ s\ {\isacharequal}\ x{\isacartoucheclose}\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sconst{\isacharunderscore}cycle{\isacharcolon}\ {\isachardoublequoteopen}sconst\ x\ {\isacharequal}\ cycle\ {\isacharbrackleft}x{\isacharbrackright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ coinduction\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}sconst{\isacharcolon}\ {\isachardoublequoteopen}smap\ f\ {\isacharparenleft}sconst\ x{\isacharparenright}\ {\isacharequal}\ sconst\ {\isacharparenleft}f\ x{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ coinduction\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sconst{\isacharunderscore}streams{\isacharcolon}\ {\isachardoublequoteopen}x\ {\isasymin}\ A\ {\isasymLongrightarrow}\ sconst\ x\ {\isasymin}\ streams\ A{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ streams{\isacharunderscore}iff{\isacharunderscore}sset{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ streams{\isacharunderscore}empty{\isacharunderscore}iff{\isacharcolon}\ {\isachardoublequoteopen}streams\ S\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}\ {\isasymlongleftrightarrow}\ S\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ S{\isachardoublequoteclose}\ {\isachardoublequoteopen}streams\ S\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sconst\ x\ {\isasymin}\ streams\ S{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ sconst{\isacharunderscore}streams{\isacharparenright}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharbraceleft}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isacartoucheopen}streams\ S\ {\isacharequal}\ {\isacharbraceleft}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ streams{\isacharunderscore}empty{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{stream of natural numbers%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}fromN\ {\isasymequiv}\ siterate\ Suc{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}nats\ {\isasymequiv}\ fromN\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}fromN{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}fromN\ n{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}n\ {\isachardot}{\isachardot}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp\ add{\isacharcolon}\ sset{\isacharunderscore}siterate\ le{\isacharunderscore}iff{\isacharunderscore}add{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stream{\isacharunderscore}smap{\isacharunderscore}fromN{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isacharequal}\ smap\ {\isacharparenleft}{\isasymlambda}j{\isachardot}\ let\ i\ {\isacharequal}\ j\ {\isacharminus}\ n\ in\ s\ {\isacharbang}{\isacharbang}\ i{\isacharparenright}\ {\isacharparenleft}fromN\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ s\ n{\isacharparenright}\isanewline
\ \ \ \ {\isacharparenleft}force\ simp{\isacharcolon}\ neq{\isacharunderscore}Nil{\isacharunderscore}conv\ Let{\isacharunderscore}def\ Suc{\isacharunderscore}diff{\isacharunderscore}Suc\ simp\ flip{\isacharcolon}\ snth{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\isanewline
\ \ \ \ \ \ intro{\isacharcolon}\ stream{\isachardot}map{\isacharunderscore}cong\ split{\isacharcolon}\ if{\isacharunderscore}splits{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stream{\isacharunderscore}smap{\isacharunderscore}nats{\isacharcolon}\ {\isachardoublequoteopen}s\ {\isacharequal}\ smap\ {\isacharparenleft}snth\ s{\isacharparenright}\ nats{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ stream{\isacharunderscore}smap{\isacharunderscore}fromN{\isacharbrackleft}\isakeyword{where}\ n\ {\isacharequal}\ {\isadigit{0}}{\isacharbrackright}\ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{flatten a stream of lists%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primcorec}\isamarkupfalse%
\ flat\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}flat\ ws{\isacharparenright}\ {\isacharequal}\ hd\ {\isacharparenleft}shd\ ws{\isacharparenright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}flat\ ws{\isacharparenright}\ {\isacharequal}\ flat\ {\isacharparenleft}if\ tl\ {\isacharparenleft}shd\ ws{\isacharparenright}\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ then\ stl\ ws\ else\ tl\ {\isacharparenleft}shd\ ws{\isacharparenright}\ {\isacharhash}{\isacharhash}\ stl\ ws{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}Cons{\isacharbrackleft}simp{\isacharcomma}\ code{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}flat\ {\isacharparenleft}{\isacharparenleft}x\ {\isacharhash}\ xs{\isacharparenright}\ {\isacharhash}{\isacharhash}\ ws{\isacharparenright}\ {\isacharequal}\ x\ {\isacharhash}{\isacharhash}\ flat\ {\isacharparenleft}if\ xs\ {\isacharequal}\ {\isacharbrackleft}{\isacharbrackright}\ then\ ws\ else\ xs\ {\isacharhash}{\isacharhash}\ ws{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ flat{\isachardot}ctr{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}Stream{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ flat\ {\isacharparenleft}xs\ {\isacharhash}{\isacharhash}\ ws{\isacharparenright}\ {\isacharequal}\ xs\ {\isacharat}{\isacharminus}\ flat\ ws{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ xs{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}unfold{\isacharcolon}\ {\isachardoublequoteopen}shd\ ws\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ flat\ ws\ {\isacharequal}\ shd\ ws\ {\isacharat}{\isacharminus}\ flat\ {\isacharparenleft}stl\ ws{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ ws{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ flat{\isacharunderscore}snth{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}xs\ {\isasymin}\ sset\ s{\isachardot}\ xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\ flat\ s\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ {\isacharparenleft}if\ n\ {\isacharless}\ length\ {\isacharparenleft}shd\ s{\isacharparenright}\ then\isanewline
\ \ shd\ s\ {\isacharbang}\ n\ else\ flat\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}n\ {\isacharminus}\ length\ {\isacharparenleft}shd\ s{\isacharparenright}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ flat{\isacharunderscore}unfold\ not{\isacharunderscore}less\ shd{\isacharunderscore}sset\ shift{\isacharunderscore}snth{\isacharunderscore}ge\ shift{\isacharunderscore}snth{\isacharunderscore}less{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}flat{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}{\isasymforall}xs\ {\isasymin}\ sset\ s{\isachardot}\ xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}\ {\isasymLongrightarrow}\isanewline
\ \ sset\ {\isacharparenleft}flat\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymUnion}xs\ {\isasymin}\ sset\ s{\isachardot}\ set\ xs{\isacharparenright}{\isachardoublequoteclose}\ {\isacharparenleft}\isakeyword{is}\ {\isachardoublequoteopen}{\isacharquery}P\ {\isasymLongrightarrow}\ {\isacharquery}L\ {\isacharequal}\ {\isacharquery}R{\isachardoublequoteclose}{\isacharparenright}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isacharquery}P\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}L{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ m\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ flat\ s\ {\isacharbang}{\isacharbang}\ m{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ image{\isacharunderscore}iff\ sset{\isacharunderscore}range{\isacharparenright}\isanewline
\ \ \isacommand{with}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharquery}P{\isacartoucheclose}\ \isacommand{obtain}\isamarkupfalse%
\ n\ m{\isacharprime}\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ n\ {\isacharbang}\ m{\isacharprime}{\isachardoublequoteclose}\ {\isachardoublequoteopen}m{\isacharprime}\ {\isacharless}\ length\ {\isacharparenleft}s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}atomize{\isacharunderscore}elim{\isacharcomma}\ induct\ m\ arbitrary{\isacharcolon}\ s\ rule{\isacharcolon}\ less{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}less\ y{\isacharparenright}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}case\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}y\ {\isacharless}\ length\ {\isacharparenleft}shd\ s{\isacharparenright}{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ flat{\isacharunderscore}snth\ less{\isacharparenleft}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharparenright}\ snth{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharequal}\ flat\ {\isacharparenleft}stl\ s{\isacharparenright}\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}y\ {\isacharminus}\ length\ {\isacharparenleft}shd\ s{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ less{\isacharparenleft}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharparenright}\ flat{\isacharunderscore}snth{\isacharparenright}\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{{\isacharbraceleft}}\isamarkupfalse%
\ \isacommand{from}\isamarkupfalse%
\ less{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\isacharcolon}\ {\isachardoublequoteopen}length\ {\isacharparenleft}shd\ s{\isacharparenright}\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ False\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isachargreater}\ {\isadigit{0}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ y{\isacharparenright}\ simp{\isacharunderscore}all\isanewline
\ \ \ \ \ \ \ \ \isacommand{with}\isamarkupfalse%
\ {\isacharasterisk}\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isacharminus}\ length\ {\isacharparenleft}shd\ s{\isacharparenright}\ {\isacharless}\ y{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \ \ \isacommand{{\isacharbraceright}}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}xs\ {\isasymin}\ sset\ {\isacharparenleft}stl\ s{\isacharparenright}{\isachardot}\ xs\ {\isasymnoteq}\ {\isacharbrackleft}{\isacharbrackright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ less{\isacharparenleft}{\isadigit{2}}{\isacharparenright}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ s{\isacharparenright}\ auto\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n\ m{\isacharprime}{\isachardot}\ x\ {\isacharequal}\ stl\ s\ {\isacharbang}{\isacharbang}\ n\ {\isacharbang}\ m{\isacharprime}\ {\isasymand}\ m{\isacharprime}\ {\isacharless}\ length\ {\isacharparenleft}stl\ s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}intro\ less{\isacharparenleft}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ auto\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}metis\ snth{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}R{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sset{\isacharunderscore}range\ dest{\isacharbang}{\isacharcolon}\ nth{\isacharunderscore}mem{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ xs\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}xs\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\ {\isacharquery}P\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ xs{\isachardoublequoteclose}\ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isacharquery}L{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ rule{\isacharcolon}\ sset{\isacharunderscore}induct{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharparenleft}metis\ UnI{\isadigit{1}}\ flat{\isacharunderscore}unfold\ shift{\isachardot}simps{\isacharparenleft}{\isadigit{1}}{\isacharparenright}\ sset{\isacharunderscore}shift{\isacharcomma}\isanewline
\ \ \ \ \ \ \ metis\ UnI{\isadigit{2}}\ flat{\isacharunderscore}unfold\ shd{\isacharunderscore}sset\ stl{\isacharunderscore}sset\ sset{\isacharunderscore}shift{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{merge a stream of streams%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ smerge\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ stream\ stream\ {\isasymRightarrow}\ {\isacharprime}a\ stream{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}smerge\ ss\ {\isacharequal}\ flat\ {\isacharparenleft}smap\ {\isacharparenleft}{\isasymlambda}n{\isachardot}\ map\ {\isacharparenleft}{\isasymlambda}s{\isachardot}\ s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}\ {\isacharparenleft}stake\ {\isacharparenleft}Suc\ n{\isacharparenright}\ ss{\isacharparenright}\ {\isacharat}\ stake\ n\ {\isacharparenleft}ss\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isacharparenright}\ nats{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}nth{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}m\ {\isacharless}\ n\ {\isasymLongrightarrow}\ stake\ n\ s\ {\isacharbang}\ m\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ m{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s\ m{\isacharparenright}\ {\isacharparenleft}auto\ simp{\isacharcolon}\ nth{\isacharunderscore}Cons{\isacharprime}{\isacharcomma}\ metis\ Suc{\isacharunderscore}pred\ snth{\isachardot}simps{\isacharparenleft}{\isadigit{2}}{\isacharparenright}{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}sset{\isacharunderscore}smerge{\isacharcolon}\ {\isachardoublequoteopen}ss\ {\isacharbang}{\isacharbang}\ n\ {\isacharbang}{\isacharbang}\ m\ {\isasymin}\ sset\ {\isacharparenleft}smerge\ ss{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}n\ {\isasymle}\ m{\isachardoublequoteclose}{\isacharparenright}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ False\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ smerge{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sset{\isacharunderscore}flat{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharparenleft}auto\ simp{\isacharcolon}\ stream{\isachardot}set{\isacharunderscore}map\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ simp\ del{\isacharcolon}\ stake{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ intro{\isacharbang}{\isacharcolon}\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ n{\isacharcomma}\ OF\ disjI{\isadigit{2}}{\isacharbrackright}\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ m{\isacharcomma}\ OF\ mp{\isacharbrackright}{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ True\ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ smerge{\isacharunderscore}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sset{\isacharunderscore}flat{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharparenleft}auto\ simp{\isacharcolon}\ stream{\isachardot}set{\isacharunderscore}map\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ image{\isacharunderscore}iff\ simp\ del{\isacharcolon}\ stake{\isachardot}simps\ snth{\isachardot}simps\isanewline
\ \ \ \ \ \ \ \ intro{\isacharbang}{\isacharcolon}\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ m{\isacharcomma}\ OF\ disjI{\isadigit{1}}{\isacharbrackright}\ bexI{\isacharbrackleft}of\ {\isacharunderscore}\ {\isachardoublequoteopen}ss\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}{\isacharbrackright}\ exI{\isacharbrackleft}of\ {\isacharunderscore}\ n{\isacharcomma}\ OF\ mp{\isacharbrackright}{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}smerge{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}smerge\ ss{\isacharparenright}\ {\isacharequal}\ UNION\ {\isacharparenleft}sset\ ss{\isacharparenright}\ sset{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ safe\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ {\isacharparenleft}smerge\ ss{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ UNION\ {\isacharparenleft}sset\ ss{\isacharparenright}\ sset{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ smerge{\isacharunderscore}def\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ {\isacharparenleft}asm{\isacharparenright}\ sset{\isacharunderscore}flat{\isacharparenright}\isanewline
\ \ \ \ \ \ {\isacharparenleft}auto\ simp{\isacharcolon}\ stream{\isachardot}set{\isacharunderscore}map\ in{\isacharunderscore}set{\isacharunderscore}conv{\isacharunderscore}nth\ sset{\isacharunderscore}range\ simp\ del{\isacharcolon}\ stake{\isachardot}simps{\isacharcomma}\ fast{\isacharplus}{\isacharparenright}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ s\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}s\ {\isasymin}\ sset\ ss{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ {\isacharparenleft}smerge\ ss{\isacharparenright}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ snth{\isacharunderscore}sset{\isacharunderscore}smerge\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ sset{\isacharunderscore}range{\isacharparenright}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{product of two streams%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ sproduct\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharprime}a\ stream\ {\isasymRightarrow}\ {\isacharprime}b\ stream\ {\isasymRightarrow}\ {\isacharparenleft}{\isacharprime}a\ {\isasymtimes}\ {\isacharprime}b{\isacharparenright}\ stream{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}sproduct\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharequal}\ smerge\ {\isacharparenleft}smap\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ smap\ {\isacharparenleft}Pair\ x{\isacharparenright}\ s{\isadigit{2}}{\isacharparenright}\ s{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}sproduct{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}sproduct\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ sset\ s{\isadigit{1}}\ {\isasymtimes}\ sset\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ sproduct{\isacharunderscore}def\ sset{\isacharunderscore}smerge\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}auto\ simp{\isacharcolon}\ stream{\isachardot}set{\isacharunderscore}map{\isacharparenright}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{interleave two streams%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primcorec}\isamarkupfalse%
\ sinterleave\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ shd\ s{\isadigit{1}}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ sinterleave\ s{\isadigit{2}}\ {\isacharparenleft}stl\ s{\isadigit{1}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sinterleave{\isacharunderscore}code{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sinterleave\ {\isacharparenleft}x\ {\isacharhash}{\isacharhash}\ s{\isadigit{1}}{\isacharparenright}\ s{\isadigit{2}}\ {\isacharequal}\ x\ {\isacharhash}{\isacharhash}\ sinterleave\ s{\isadigit{2}}\ s{\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ sinterleave{\isachardot}ctr{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sinterleave{\isacharunderscore}snth{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}even\ n\ {\isasymLongrightarrow}\ sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ s{\isadigit{1}}\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ {\isachardoublequoteopen}odd\ n\ {\isasymLongrightarrow}\ sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}n\ div\ {\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ simp{\isacharunderscore}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sset{\isacharunderscore}sinterleave{\isacharcolon}\ {\isachardoublequoteopen}sset\ {\isacharparenleft}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ sset\ s{\isadigit{1}}\ {\isasymunion}\ sset\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}intro\ equalityI\ subsetI{\isacharparenright}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ {\isacharparenleft}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ sset{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isadigit{1}}\ {\isasymunion}\ sset\ s{\isadigit{2}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}cases\ {\isachardoublequoteopen}even\ n{\isachardoublequoteclose}{\isacharparenright}\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isadigit{1}}\ {\isasymunion}\ sset\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ {\isacharparenleft}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ s{\isadigit{1}}\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ sset{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}{\isadigit{2}}\ {\isacharasterisk}\ n{\isacharparenright}\ {\isacharequal}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sset{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ sset\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}x\ {\isacharequal}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ sset{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}sinterleave\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ {\isacharparenleft}{\isadigit{2}}\ {\isacharasterisk}\ n\ {\isacharplus}\ {\isadigit{1}}{\isacharparenright}\ {\isacharequal}\ x{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ sset{\isacharunderscore}range\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{zip%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primcorec}\isamarkupfalse%
\ szip\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}shd\ s{\isadigit{1}}{\isacharcomma}\ shd\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ szip\ {\isacharparenleft}stl\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}stl\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ szip{\isacharunderscore}unfold{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}szip\ {\isacharparenleft}a\ {\isacharhash}{\isacharhash}\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}b\ {\isacharhash}{\isacharhash}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}a{\isacharcomma}\ b{\isacharparenright}\ {\isacharhash}{\isacharhash}\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ szip{\isachardot}ctr{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}szip{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}szip\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ {\isacharparenleft}s{\isadigit{1}}\ {\isacharbang}{\isacharbang}\ n{\isacharcomma}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}szip{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}stake\ n\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ zip\ {\isacharparenleft}stake\ n\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}stake\ n\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}szip{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\ {\isachardoublequoteopen}sdrop\ n\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ szip\ {\isacharparenleft}sdrop\ n\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}sdrop\ n\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}szip{\isacharunderscore}fst{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}smap\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ f\ {\isacharparenleft}fst\ x{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ smap\ f\ s{\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}szip{\isacharunderscore}snd{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}smap\ {\isacharparenleft}{\isasymlambda}x{\isachardot}\ g\ {\isacharparenleft}snd\ x{\isacharparenright}{\isacharparenright}\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ smap\ g\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{zip via function%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{primcorec}\isamarkupfalse%
\ smap{\isadigit{2}}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}shd\ {\isacharparenleft}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ f\ {\isacharparenleft}shd\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}shd\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
{\isacharbar}\ {\isachardoublequoteopen}stl\ {\isacharparenleft}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ smap{\isadigit{2}}\ f\ {\isacharparenleft}stl\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}stl\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isadigit{2}}{\isacharunderscore}unfold{\isacharbrackleft}code{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}smap{\isadigit{2}}\ f\ {\isacharparenleft}a\ {\isacharhash}{\isacharhash}\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}b\ {\isacharhash}{\isacharhash}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ f\ a\ b\ {\isacharhash}{\isacharhash}\ {\isacharparenleft}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}subst\ smap{\isadigit{2}}{\isachardot}ctr{\isacharparenright}\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isadigit{2}}{\isacharunderscore}szip{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharequal}\ smap\ {\isacharparenleft}case{\isacharunderscore}prod\ f{\isacharparenright}\ {\isacharparenleft}szip\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}coinduction\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isacharunderscore}smap{\isadigit{2}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}smap\ f\ {\isacharparenleft}smap{\isadigit{2}}\ g\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ smap{\isadigit{2}}\ {\isacharparenleft}{\isasymlambda}x\ y{\isachardot}\ f\ {\isacharparenleft}g\ x\ y{\isacharparenright}{\isacharparenright}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ smap{\isadigit{2}}{\isacharunderscore}szip\ stream{\isachardot}map{\isacharunderscore}comp\ o{\isacharunderscore}def\ split{\isacharunderscore}def\ \isacommand{{\isachardot}{\isachardot}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ smap{\isadigit{2}}{\isacharunderscore}alt{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharequal}\ s{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}n{\isachardot}\ f\ {\isacharparenleft}s{\isadigit{1}}\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}\ {\isacharparenleft}s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}\ {\isacharequal}\ s\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ smap{\isadigit{2}}{\isacharunderscore}szip\ smap{\isacharunderscore}alt\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ snth{\isacharunderscore}smap{\isadigit{2}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n\ {\isacharequal}\ f\ {\isacharparenleft}s{\isadigit{1}}\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}\ {\isacharparenleft}s{\isadigit{2}}\ {\isacharbang}{\isacharbang}\ n{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ stake{\isacharunderscore}smap{\isadigit{2}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}stake\ n\ {\isacharparenleft}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ map\ {\isacharparenleft}case{\isacharunderscore}prod\ f{\isacharparenright}\ {\isacharparenleft}zip\ {\isacharparenleft}stake\ n\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}stake\ n\ s{\isadigit{2}}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sdrop{\isacharunderscore}smap{\isadigit{2}}{\isacharbrackleft}simp{\isacharbrackright}{\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}sdrop\ n\ {\isacharparenleft}smap{\isadigit{2}}\ f\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ {\isacharequal}\ smap{\isadigit{2}}\ f\ {\isacharparenleft}sdrop\ n\ s{\isadigit{1}}{\isacharparenright}\ {\isacharparenleft}sdrop\ n\ s{\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}induct\ n\ arbitrary{\isacharcolon}\ s{\isadigit{1}}\ s{\isadigit{2}}{\isacharparenright}\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~~/src/HOL/Library/Stream.thy%:%
%:%11=9%:%
%:%27=11%:%
%:%28=11%:%
%:%29=12%:%
%:%30=13%:%
%:%35=13%:%
%:%38=14%:%
%:%39=15%:%
%:%40=15%:%
%:%41=16%:%
%:%42=17%:%
%:%43=18%:%
%:%44=19%:%
%:%45=20%:%
%:%46=21%:%
%:%47=21%:%
%:%48=22%:%
%:%49=23%:%
%:%51=24%:%
%:%52=24%:%
%:%53=25%:%
%:%54=25%:%
%:%55=26%:%
%:%56=27%:%
%:%57=28%:%
%:%58=28%:%
%:%61=29%:%
%:%65=29%:%
%:%66=29%:%
%:%67=29%:%
%:%72=29%:%
%:%75=30%:%
%:%76=31%:%
%:%77=31%:%
%:%78=32%:%
%:%79=33%:%
%:%80=33%:%
%:%81=34%:%
%:%82=34%:%
%:%83=35%:%
%:%84=35%:%
%:%85=36%:%
%:%86=37%:%
%:%87=37%:%
%:%88=38%:%
%:%89=39%:%
%:%96=40%:%
%:%97=40%:%
%:%98=40%:%
%:%103=40%:%
%:%106=41%:%
%:%107=42%:%
%:%108=42%:%
%:%111=43%:%
%:%115=43%:%
%:%116=43%:%
%:%130=45%:%
%:%140=47%:%
%:%141=47%:%
%:%142=48%:%
%:%143=49%:%
%:%144=50%:%
%:%145=51%:%
%:%146=51%:%
%:%149=52%:%
%:%153=52%:%
%:%154=52%:%
%:%159=52%:%
%:%162=53%:%
%:%163=54%:%
%:%164=54%:%
%:%167=55%:%
%:%171=55%:%
%:%172=55%:%
%:%177=55%:%
%:%180=56%:%
%:%181=57%:%
%:%182=57%:%
%:%183=58%:%
%:%184=59%:%
%:%187=60%:%
%:%191=60%:%
%:%192=60%:%
%:%197=60%:%
%:%200=61%:%
%:%201=62%:%
%:%202=62%:%
%:%205=63%:%
%:%209=63%:%
%:%210=63%:%
%:%215=63%:%
%:%218=64%:%
%:%219=65%:%
%:%220=65%:%
%:%223=66%:%
%:%227=66%:%
%:%228=66%:%
%:%242=69%:%
%:%252=71%:%
%:%253=71%:%
%:%254=72%:%
%:%255=73%:%
%:%256=74%:%
%:%257=75%:%
%:%258=75%:%
%:%259=76%:%
%:%260=77%:%
%:%261=78%:%
%:%262=79%:%
%:%263=80%:%
%:%264=81%:%
%:%265=81%:%
%:%266=82%:%
%:%267=83%:%
%:%268=83%:%
%:%271=84%:%
%:%275=84%:%
%:%276=84%:%
%:%281=84%:%
%:%284=85%:%
%:%285=86%:%
%:%286=86%:%
%:%289=87%:%
%:%293=87%:%
%:%294=87%:%
%:%299=87%:%
%:%302=88%:%
%:%303=89%:%
%:%304=89%:%
%:%307=90%:%
%:%311=90%:%
%:%312=90%:%
%:%317=90%:%
%:%320=91%:%
%:%321=92%:%
%:%322=92%:%
%:%325=93%:%
%:%329=93%:%
%:%330=93%:%
%:%335=93%:%
%:%338=94%:%
%:%339=95%:%
%:%340=95%:%
%:%343=96%:%
%:%347=96%:%
%:%348=96%:%
%:%353=96%:%
%:%356=97%:%
%:%357=98%:%
%:%358=98%:%
%:%361=99%:%
%:%365=99%:%
%:%366=99%:%
%:%371=99%:%
%:%374=100%:%
%:%375=101%:%
%:%376=101%:%
%:%379=102%:%
%:%383=102%:%
%:%384=102%:%
%:%389=102%:%
%:%392=103%:%
%:%393=104%:%
%:%394=104%:%
%:%395=105%:%
%:%396=106%:%
%:%403=107%:%
%:%404=107%:%
%:%405=107%:%
%:%406=108%:%
%:%407=108%:%
%:%408=108%:%
%:%409=108%:%
%:%410=108%:%
%:%411=109%:%
%:%417=109%:%
%:%420=110%:%
%:%421=111%:%
%:%422=111%:%
%:%423=112%:%
%:%424=113%:%
%:%431=114%:%
%:%432=114%:%
%:%433=115%:%
%:%434=115%:%
%:%435=115%:%
%:%436=115%:%
%:%437=115%:%
%:%438=116%:%
%:%439=116%:%
%:%440=117%:%
%:%446=117%:%
%:%449=118%:%
%:%450=119%:%
%:%451=119%:%
%:%454=120%:%
%:%458=120%:%
%:%459=120%:%
%:%464=120%:%
%:%467=121%:%
%:%468=122%:%
%:%469=122%:%
%:%472=123%:%
%:%476=123%:%
%:%477=123%:%
%:%478=123%:%
%:%483=123%:%
%:%486=124%:%
%:%487=125%:%
%:%488=125%:%
%:%491=126%:%
%:%495=126%:%
%:%496=126%:%
%:%501=126%:%
%:%504=127%:%
%:%505=128%:%
%:%506=128%:%
%:%509=129%:%
%:%513=129%:%
%:%514=129%:%
%:%515=129%:%
%:%520=129%:%
%:%523=130%:%
%:%524=131%:%
%:%525=131%:%
%:%528=132%:%
%:%532=132%:%
%:%533=132%:%
%:%538=132%:%
%:%541=133%:%
%:%542=134%:%
%:%543=134%:%
%:%546=135%:%
%:%550=135%:%
%:%551=135%:%
%:%565=137%:%
%:%575=139%:%
%:%576=139%:%
%:%577=140%:%
%:%578=141%:%
%:%579=142%:%
%:%580=143%:%
%:%581=143%:%
%:%584=144%:%
%:%588=144%:%
%:%589=144%:%
%:%594=144%:%
%:%597=145%:%
%:%598=146%:%
%:%599=146%:%
%:%602=147%:%
%:%606=147%:%
%:%607=147%:%
%:%612=147%:%
%:%615=148%:%
%:%616=149%:%
%:%617=149%:%
%:%620=150%:%
%:%624=150%:%
%:%625=150%:%
%:%630=150%:%
%:%633=151%:%
%:%634=152%:%
%:%635=152%:%
%:%638=153%:%
%:%642=153%:%
%:%643=153%:%
%:%648=153%:%
%:%651=154%:%
%:%652=155%:%
%:%653=155%:%
%:%656=156%:%
%:%660=156%:%
%:%661=156%:%
%:%666=156%:%
%:%669=157%:%
%:%670=158%:%
%:%671=158%:%
%:%674=159%:%
%:%678=159%:%
%:%679=159%:%
%:%684=159%:%
%:%687=160%:%
%:%688=161%:%
%:%689=161%:%
%:%696=162%:%
%:%697=162%:%
%:%698=163%:%
%:%699=163%:%
%:%700=163%:%
%:%701=164%:%
%:%702=164%:%
%:%703=165%:%
%:%704=165%:%
%:%705=166%:%
%:%706=166%:%
%:%707=167%:%
%:%708=167%:%
%:%709=167%:%
%:%710=167%:%
%:%711=168%:%
%:%712=168%:%
%:%713=168%:%
%:%714=169%:%
%:%715=169%:%
%:%716=170%:%
%:%717=170%:%
%:%722=170%:%
%:%725=171%:%
%:%726=172%:%
%:%727=172%:%
%:%730=173%:%
%:%734=173%:%
%:%735=173%:%
%:%740=173%:%
%:%743=174%:%
%:%744=175%:%
%:%745=175%:%
%:%748=176%:%
%:%752=176%:%
%:%753=176%:%
%:%758=176%:%
%:%761=177%:%
%:%762=178%:%
%:%763=178%:%
%:%764=179%:%
%:%765=180%:%
%:%766=181%:%
%:%767=182%:%
%:%768=182%:%
%:%771=183%:%
%:%775=183%:%
%:%776=183%:%
%:%781=183%:%
%:%784=184%:%
%:%785=185%:%
%:%786=185%:%
%:%789=186%:%
%:%793=186%:%
%:%794=186%:%
%:%799=186%:%
%:%802=187%:%
%:%803=188%:%
%:%804=188%:%
%:%811=189%:%
%:%812=189%:%
%:%813=190%:%
%:%814=190%:%
%:%815=190%:%
%:%816=190%:%
%:%817=191%:%
%:%818=191%:%
%:%823=191%:%
%:%826=192%:%
%:%827=193%:%
%:%828=193%:%
%:%829=194%:%
%:%830=195%:%
%:%831=196%:%
%:%832=197%:%
%:%833=197%:%
%:%834=198%:%
%:%837=199%:%
%:%841=199%:%
%:%842=199%:%
%:%847=199%:%
%:%850=200%:%
%:%851=201%:%
%:%852=201%:%
%:%855=202%:%
%:%859=202%:%
%:%860=202%:%
%:%865=202%:%
%:%868=203%:%
%:%869=204%:%
%:%870=204%:%
%:%873=205%:%
%:%877=205%:%
%:%878=205%:%
%:%883=205%:%
%:%886=206%:%
%:%887=207%:%
%:%888=207%:%
%:%895=208%:%
%:%896=208%:%
%:%897=209%:%
%:%898=209%:%
%:%899=209%:%
%:%900=209%:%
%:%901=210%:%
%:%902=210%:%
%:%907=210%:%
%:%910=211%:%
%:%911=212%:%
%:%912=212%:%
%:%915=213%:%
%:%919=213%:%
%:%920=213%:%
%:%925=213%:%
%:%928=214%:%
%:%929=215%:%
%:%930=215%:%
%:%931=216%:%
%:%934=217%:%
%:%938=217%:%
%:%939=217%:%
%:%944=217%:%
%:%947=218%:%
%:%948=219%:%
%:%949=219%:%
%:%956=220%:%
%:%957=220%:%
%:%958=221%:%
%:%959=221%:%
%:%960=222%:%
%:%961=222%:%
%:%962=222%:%
%:%963=223%:%
%:%964=223%:%
%:%965=224%:%
%:%966=224%:%
%:%967=224%:%
%:%968=224%:%
%:%969=224%:%
%:%970=225%:%
%:%971=225%:%
%:%976=225%:%
%:%979=226%:%
%:%980=227%:%
%:%981=227%:%
%:%984=228%:%
%:%988=228%:%
%:%989=228%:%
%:%994=228%:%
%:%997=229%:%
%:%998=230%:%
%:%999=230%:%
%:%1002=231%:%
%:%1006=231%:%
%:%1007=231%:%
%:%1012=231%:%
%:%1015=232%:%
%:%1016=233%:%
%:%1017=233%:%
%:%1020=234%:%
%:%1024=234%:%
%:%1025=234%:%
%:%1030=234%:%
%:%1033=235%:%
%:%1034=236%:%
%:%1035=236%:%
%:%1038=237%:%
%:%1042=237%:%
%:%1043=237%:%
%:%1048=237%:%
%:%1051=238%:%
%:%1052=239%:%
%:%1053=239%:%
%:%1056=240%:%
%:%1060=240%:%
%:%1061=240%:%
%:%1066=240%:%
%:%1069=241%:%
%:%1070=242%:%
%:%1071=242%:%
%:%1074=243%:%
%:%1078=243%:%
%:%1079=243%:%
%:%1084=243%:%
%:%1087=244%:%
%:%1088=245%:%
%:%1089=245%:%
%:%1090=246%:%
%:%1091=247%:%
%:%1092=248%:%
%:%1093=248%:%
%:%1094=249%:%
%:%1097=250%:%
%:%1101=250%:%
%:%1102=250%:%
%:%1107=250%:%
%:%1110=251%:%
%:%1111=252%:%
%:%1112=252%:%
%:%1113=253%:%
%:%1114=254%:%
%:%1121=255%:%
%:%1122=255%:%
%:%1123=256%:%
%:%1124=256%:%
%:%1125=256%:%
%:%1126=257%:%
%:%1127=257%:%
%:%1128=258%:%
%:%1129=258%:%
%:%1130=258%:%
%:%1131=259%:%
%:%1132=259%:%
%:%1133=260%:%
%:%1134=260%:%
%:%1135=261%:%
%:%1136=261%:%
%:%1137=262%:%
%:%1138=262%:%
%:%1139=263%:%
%:%1140=263%:%
%:%1141=263%:%
%:%1142=263%:%
%:%1143=263%:%
%:%1144=264%:%
%:%1145=264%:%
%:%1146=264%:%
%:%1147=264%:%
%:%1148=265%:%
%:%1149=265%:%
%:%1150=266%:%
%:%1156=266%:%
%:%1159=267%:%
%:%1160=268%:%
%:%1161=268%:%
%:%1162=269%:%
%:%1163=270%:%
%:%1164=271%:%
%:%1165=272%:%
%:%1166=272%:%
%:%1173=273%:%
%:%1174=273%:%
%:%1175=274%:%
%:%1176=274%:%
%:%1177=274%:%
%:%1178=274%:%
%:%1179=275%:%
%:%1180=275%:%
%:%1181=276%:%
%:%1182=276%:%
%:%1183=276%:%
%:%1184=276%:%
%:%1185=277%:%
%:%1200=280%:%
%:%1210=282%:%
%:%1211=282%:%
%:%1212=283%:%
%:%1213=284%:%
%:%1214=284%:%
%:%1217=285%:%
%:%1221=285%:%
%:%1222=285%:%
%:%1223=285%:%
%:%1228=285%:%
%:%1231=286%:%
%:%1232=287%:%
%:%1233=287%:%
%:%1236=288%:%
%:%1240=288%:%
%:%1241=288%:%
%:%1242=288%:%
%:%1247=288%:%
%:%1250=289%:%
%:%1251=290%:%
%:%1252=290%:%
%:%1255=291%:%
%:%1259=291%:%
%:%1260=291%:%
%:%1274=294%:%
%:%1284=296%:%
%:%1285=296%:%
%:%1286=297%:%
%:%1287=298%:%
%:%1288=299%:%
%:%1289=300%:%
%:%1290=300%:%
%:%1297=301%:%
%:%1298=301%:%
%:%1299=302%:%
%:%1300=302%:%
%:%1301=302%:%
%:%1302=302%:%
%:%1303=302%:%
%:%1304=303%:%
%:%1305=303%:%
%:%1306=304%:%
%:%1312=304%:%
%:%1315=305%:%
%:%1316=306%:%
%:%1317=306%:%
%:%1320=307%:%
%:%1324=307%:%
%:%1325=307%:%
%:%1330=307%:%
%:%1333=308%:%
%:%1334=309%:%
%:%1335=309%:%
%:%1338=310%:%
%:%1342=310%:%
%:%1343=310%:%
%:%1348=310%:%
%:%1351=311%:%
%:%1352=312%:%
%:%1353=312%:%
%:%1360=313%:%
%:%1361=313%:%
%:%1362=314%:%
%:%1363=314%:%
%:%1364=314%:%
%:%1365=314%:%
%:%1366=315%:%
%:%1367=315%:%
%:%1372=315%:%
%:%1375=316%:%
%:%1376=317%:%
%:%1377=317%:%
%:%1378=318%:%
%:%1379=319%:%
%:%1386=320%:%
%:%1387=320%:%
%:%1388=321%:%
%:%1389=321%:%
%:%1394=321%:%
%:%1397=322%:%
%:%1398=323%:%
%:%1399=323%:%
%:%1402=324%:%
%:%1406=324%:%
%:%1407=324%:%
%:%1412=324%:%
%:%1415=325%:%
%:%1416=326%:%
%:%1417=326%:%
%:%1420=327%:%
%:%1424=327%:%
%:%1425=327%:%
%:%1430=327%:%
%:%1433=328%:%
%:%1434=329%:%
%:%1435=329%:%
%:%1436=330%:%
%:%1439=331%:%
%:%1443=331%:%
%:%1444=331%:%
%:%1445=332%:%
%:%1450=332%:%
%:%1453=333%:%
%:%1454=334%:%
%:%1455=334%:%
%:%1456=335%:%
%:%1459=336%:%
%:%1463=336%:%
%:%1464=336%:%
%:%1465=337%:%
%:%1470=337%:%
%:%1473=338%:%
%:%1474=339%:%
%:%1475=339%:%
%:%1476=340%:%
%:%1479=341%:%
%:%1483=341%:%
%:%1484=341%:%
%:%1489=341%:%
%:%1492=342%:%
%:%1493=343%:%
%:%1494=343%:%
%:%1497=344%:%
%:%1501=344%:%
%:%1502=344%:%
%:%1507=344%:%
%:%1510=345%:%
%:%1511=346%:%
%:%1512=346%:%
%:%1513=347%:%
%:%1514=348%:%
%:%1521=349%:%
%:%1522=349%:%
%:%1523=350%:%
%:%1524=350%:%
%:%1525=351%:%
%:%1526=351%:%
%:%1527=352%:%
%:%1528=352%:%
%:%1529=352%:%
%:%1530=352%:%
%:%1531=353%:%
%:%1532=353%:%
%:%1533=354%:%
%:%1534=354%:%
%:%1548=357%:%
%:%1558=359%:%
%:%1559=359%:%
%:%1560=360%:%
%:%1561=361%:%
%:%1562=362%:%
%:%1563=363%:%
%:%1564=363%:%
%:%1567=364%:%
%:%1571=364%:%
%:%1572=364%:%
%:%1577=364%:%
%:%1580=365%:%
%:%1581=366%:%
%:%1582=366%:%
%:%1585=367%:%
%:%1589=367%:%
%:%1590=367%:%
%:%1595=367%:%
%:%1598=368%:%
%:%1599=369%:%
%:%1600=369%:%
%:%1603=370%:%
%:%1607=370%:%
%:%1608=370%:%
%:%1613=370%:%
%:%1616=371%:%
%:%1617=372%:%
%:%1618=372%:%
%:%1621=373%:%
%:%1625=373%:%
%:%1626=373%:%
%:%1631=373%:%
%:%1634=374%:%
%:%1635=375%:%
%:%1636=375%:%
%:%1639=376%:%
%:%1643=376%:%
%:%1644=376%:%
%:%1649=376%:%
%:%1652=377%:%
%:%1653=378%:%
%:%1654=378%:%
%:%1657=379%:%
%:%1661=379%:%
%:%1662=379%:%
%:%1676=382%:%
%:%1686=384%:%
%:%1687=384%:%
%:%1688=385%:%
%:%1689=386%:%
%:%1690=386%:%
%:%1693=387%:%
%:%1697=387%:%
%:%1698=387%:%
%:%1703=387%:%
%:%1706=388%:%
%:%1707=389%:%
%:%1708=389%:%
%:%1711=390%:%
%:%1715=390%:%
%:%1716=390%:%
%:%1721=390%:%
%:%1724=391%:%
%:%1725=392%:%
%:%1726=392%:%
%:%1733=393%:%
%:%1734=393%:%
%:%1735=394%:%
%:%1736=394%:%
%:%1737=395%:%
%:%1738=395%:%
%:%1739=395%:%
%:%1740=396%:%
%:%1741=396%:%
%:%1742=397%:%
%:%1743=397%:%
%:%1744=398%:%
%:%1745=398%:%
%:%1746=398%:%
%:%1747=398%:%
%:%1748=399%:%
%:%1749=399%:%
%:%1750=399%:%
%:%1751=399%:%
%:%1752=400%:%
%:%1753=400%:%
%:%1754=400%:%
%:%1755=400%:%
%:%1756=401%:%
%:%1757=401%:%
%:%1758=402%:%
%:%1759=402%:%
%:%1764=402%:%
%:%1767=403%:%
%:%1768=404%:%
%:%1769=404%:%
%:%1772=405%:%
%:%1776=405%:%
%:%1777=405%:%
%:%1782=405%:%
%:%1785=406%:%
%:%1786=407%:%
%:%1787=407%:%
%:%1790=408%:%
%:%1794=408%:%
%:%1795=408%:%
%:%1800=408%:%
%:%1803=409%:%
%:%1804=410%:%
%:%1805=410%:%
%:%1808=411%:%
%:%1812=411%:%
%:%1813=411%:%
%:%1818=411%:%
%:%1821=412%:%
%:%1822=413%:%
%:%1823=413%:%
%:%1830=414%:%
%:%1831=414%:%
%:%1832=415%:%
%:%1833=415%:%
%:%1834=415%:%
%:%1835=416%:%
%:%1836=416%:%
%:%1837=416%:%
%:%1838=417%:%
%:%1839=417%:%
%:%1840=418%:%
%:%1841=418%:%
%:%1842=418%:%
%:%1843=419%:%
%:%1844=419%:%
%:%1845=419%:%
%:%1846=420%:%
%:%1847=420%:%
%:%1861=422%:%
%:%1871=424%:%
%:%1872=424%:%
%:%1873=425%:%
%:%1874=426%:%
%:%1875=426%:%
%:%1876=427%:%
%:%1877=428%:%
%:%1878=428%:%
%:%1881=429%:%
%:%1885=429%:%
%:%1886=429%:%
%:%1891=429%:%
%:%1894=430%:%
%:%1895=431%:%
%:%1896=431%:%
%:%1899=432%:%
%:%1903=432%:%
%:%1904=432%:%
%:%1905=433%:%
%:%1906=434%:%
%:%1911=434%:%
%:%1914=435%:%
%:%1915=436%:%
%:%1916=436%:%
%:%1919=437%:%
%:%1923=437%:%
%:%1924=437%:%
%:%1925=437%:%
%:%1939=440%:%
%:%1949=442%:%
%:%1950=442%:%
%:%1951=443%:%
%:%1952=444%:%
%:%1953=445%:%
%:%1954=446%:%
%:%1955=446%:%
%:%1958=447%:%
%:%1962=447%:%
%:%1963=447%:%
%:%1968=447%:%
%:%1971=448%:%
%:%1972=449%:%
%:%1973=449%:%
%:%1976=450%:%
%:%1980=450%:%
%:%1981=450%:%
%:%1986=450%:%
%:%1989=451%:%
%:%1990=452%:%
%:%1991=452%:%
%:%1994=453%:%
%:%1998=453%:%
%:%1999=453%:%
%:%2004=453%:%
%:%2007=454%:%
%:%2008=455%:%
%:%2009=455%:%
%:%2010=456%:%
%:%2013=457%:%
%:%2017=457%:%
%:%2018=457%:%
%:%2023=457%:%
%:%2026=458%:%
%:%2027=459%:%
%:%2028=459%:%
%:%2029=460%:%
%:%2036=461%:%
%:%2037=461%:%
%:%2038=462%:%
%:%2039=462%:%
%:%2040=462%:%
%:%2041=463%:%
%:%2042=463%:%
%:%2043=463%:%
%:%2044=463%:%
%:%2045=464%:%
%:%2046=464%:%
%:%2047=464%:%
%:%2048=465%:%
%:%2049=465%:%
%:%2050=466%:%
%:%2051=466%:%
%:%2052=467%:%
%:%2053=467%:%
%:%2054=468%:%
%:%2055=468%:%
%:%2056=469%:%
%:%2057=469%:%
%:%2058=469%:%
%:%2059=469%:%
%:%2060=470%:%
%:%2061=470%:%
%:%2062=471%:%
%:%2063=471%:%
%:%2064=472%:%
%:%2065=472%:%
%:%2066=472%:%
%:%2067=473%:%
%:%2068=473%:%
%:%2069=474%:%
%:%2070=474%:%
%:%2071=474%:%
%:%2072=474%:%
%:%2073=474%:%
%:%2074=475%:%
%:%2075=475%:%
%:%2076=475%:%
%:%2077=475%:%
%:%2078=476%:%
%:%2079=476%:%
%:%2080=476%:%
%:%2081=476%:%
%:%2082=477%:%
%:%2083=477%:%
%:%2084=478%:%
%:%2085=478%:%
%:%2086=478%:%
%:%2087=478%:%
%:%2088=478%:%
%:%2089=479%:%
%:%2090=479%:%
%:%2091=479%:%
%:%2092=479%:%
%:%2093=480%:%
%:%2094=480%:%
%:%2095=480%:%
%:%2096=481%:%
%:%2097=481%:%
%:%2098=482%:%
%:%2099=482%:%
%:%2100=483%:%
%:%2101=483%:%
%:%2102=483%:%
%:%2103=484%:%
%:%2104=484%:%
%:%2105=485%:%
%:%2106=485%:%
%:%2107=485%:%
%:%2108=485%:%
%:%2109=486%:%
%:%2110=486%:%
%:%2111=487%:%
%:%2112=488%:%
%:%2113=489%:%
%:%2128=492%:%
%:%2138=494%:%
%:%2139=494%:%
%:%2140=495%:%
%:%2141=496%:%
%:%2142=497%:%
%:%2143=497%:%
%:%2146=498%:%
%:%2150=498%:%
%:%2151=498%:%
%:%2156=498%:%
%:%2159=499%:%
%:%2160=500%:%
%:%2161=500%:%
%:%2168=501%:%
%:%2169=501%:%
%:%2170=502%:%
%:%2171=502%:%
%:%2172=502%:%
%:%2173=502%:%
%:%2174=503%:%
%:%2175=503%:%
%:%2176=504%:%
%:%2177=505%:%
%:%2178=506%:%
%:%2179=506%:%
%:%2180=507%:%
%:%2181=507%:%
%:%2182=507%:%
%:%2183=507%:%
%:%2184=508%:%
%:%2185=508%:%
%:%2186=509%:%
%:%2187=510%:%
%:%2188=511%:%
%:%2194=511%:%
%:%2197=512%:%
%:%2198=513%:%
%:%2199=513%:%
%:%2206=514%:%
%:%2207=514%:%
%:%2208=515%:%
%:%2209=515%:%
%:%2210=515%:%
%:%2211=516%:%
%:%2212=516%:%
%:%2213=517%:%
%:%2214=517%:%
%:%2215=517%:%
%:%2216=518%:%
%:%2217=519%:%
%:%2218=519%:%
%:%2219=520%:%
%:%2220=520%:%
%:%2221=520%:%
%:%2222=521%:%
%:%2223=521%:%
%:%2224=521%:%
%:%2225=521%:%
%:%2226=522%:%
%:%2241=525%:%
%:%2251=527%:%
%:%2252=527%:%
%:%2253=528%:%
%:%2254=529%:%
%:%2255=530%:%
%:%2256=530%:%
%:%2259=531%:%
%:%2263=531%:%
%:%2264=531%:%
%:%2265=531%:%
%:%2279=534%:%
%:%2289=536%:%
%:%2290=536%:%
%:%2291=537%:%
%:%2292=538%:%
%:%2293=539%:%
%:%2294=540%:%
%:%2295=540%:%
%:%2296=541%:%
%:%2299=542%:%
%:%2303=542%:%
%:%2304=542%:%
%:%2309=542%:%
%:%2312=543%:%
%:%2313=544%:%
%:%2314=544%:%
%:%2315=545%:%
%:%2316=546%:%
%:%2319=547%:%
%:%2323=547%:%
%:%2324=547%:%
%:%2329=547%:%
%:%2332=548%:%
%:%2333=549%:%
%:%2334=549%:%
%:%2341=550%:%
%:%2342=550%:%
%:%2343=551%:%
%:%2344=551%:%
%:%2345=551%:%
%:%2346=552%:%
%:%2347=552%:%
%:%2348=552%:%
%:%2349=552%:%
%:%2350=552%:%
%:%2351=553%:%
%:%2352=553%:%
%:%2353=553%:%
%:%2354=554%:%
%:%2355=554%:%
%:%2356=555%:%
%:%2357=555%:%
%:%2358=555%:%
%:%2359=556%:%
%:%2360=556%:%
%:%2361=557%:%
%:%2362=557%:%
%:%2363=558%:%
%:%2364=558%:%
%:%2365=559%:%
%:%2366=559%:%
%:%2367=559%:%
%:%2368=559%:%
%:%2369=559%:%
%:%2370=560%:%
%:%2371=560%:%
%:%2372=560%:%
%:%2373=561%:%
%:%2374=561%:%
%:%2375=561%:%
%:%2376=561%:%
%:%2377=562%:%
%:%2378=562%:%
%:%2379=563%:%
%:%2380=563%:%
%:%2381=564%:%
%:%2382=564%:%
%:%2383=564%:%
%:%2384=564%:%
%:%2385=564%:%
%:%2386=565%:%
%:%2387=565%:%
%:%2388=565%:%
%:%2389=566%:%
%:%2390=566%:%
%:%2391=566%:%
%:%2392=566%:%
%:%2393=567%:%
%:%2394=567%:%
%:%2395=568%:%
%:%2410=571%:%
%:%2420=573%:%
%:%2421=573%:%
%:%2422=574%:%
%:%2423=575%:%
%:%2424=576%:%
%:%2425=577%:%
%:%2426=577%:%
%:%2429=578%:%
%:%2433=578%:%
%:%2434=578%:%
%:%2439=578%:%
%:%2442=579%:%
%:%2443=580%:%
%:%2444=580%:%
%:%2447=581%:%
%:%2451=581%:%
%:%2452=581%:%
%:%2457=581%:%
%:%2460=582%:%
%:%2461=583%:%
%:%2462=583%:%
%:%2463=584%:%
%:%2466=585%:%
%:%2470=585%:%
%:%2471=585%:%
%:%2476=585%:%
%:%2479=586%:%
%:%2480=587%:%
%:%2481=587%:%
%:%2484=588%:%
%:%2488=588%:%
%:%2489=588%:%
%:%2494=588%:%
%:%2497=589%:%
%:%2498=590%:%
%:%2499=590%:%
%:%2500=591%:%
%:%2503=592%:%
%:%2507=592%:%
%:%2508=592%:%
%:%2513=592%:%
%:%2516=593%:%
%:%2517=594%:%
%:%2518=594%:%
%:%2519=595%:%
%:%2522=596%:%
%:%2526=596%:%
%:%2527=596%:%
%:%2541=599%:%
%:%2551=601%:%
%:%2552=601%:%
%:%2553=602%:%
%:%2554=603%:%
%:%2555=604%:%
%:%2556=605%:%
%:%2557=605%:%
%:%2558=606%:%
%:%2561=607%:%
%:%2565=607%:%
%:%2566=607%:%
%:%2571=607%:%
%:%2574=608%:%
%:%2575=609%:%
%:%2576=609%:%
%:%2577=610%:%
%:%2580=611%:%
%:%2584=611%:%
%:%2585=611%:%
%:%2590=611%:%
%:%2593=612%:%
%:%2594=613%:%
%:%2595=613%:%
%:%2596=614%:%
%:%2599=615%:%
%:%2603=615%:%
%:%2604=615%:%
%:%2610=615%:%
%:%2613=616%:%
%:%2614=617%:%
%:%2615=617%:%
%:%2616=618%:%
%:%2619=619%:%
%:%2623=619%:%
%:%2624=619%:%
%:%2625=619%:%
%:%2630=619%:%
%:%2633=620%:%
%:%2634=621%:%
%:%2635=621%:%
%:%2636=622%:%
%:%2639=623%:%
%:%2643=623%:%
%:%2644=623%:%
%:%2649=623%:%
%:%2652=624%:%
%:%2653=625%:%
%:%2654=625%:%
%:%2655=626%:%
%:%2658=627%:%
%:%2662=627%:%
%:%2663=627%:%
%:%2668=627%:%
%:%2671=628%:%
%:%2672=629%:%
%:%2673=629%:%
%:%2674=630%:%
%:%2677=631%:%
%:%2681=631%:%
%:%2682=631%:%
%:%2687=631%:%
%:%2692=632%:%
%:%2697=633%:%